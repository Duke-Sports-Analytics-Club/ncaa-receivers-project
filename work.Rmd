---
title: "Predicting NFL Wide Receiver Success Using Combine Measurables and PFF College Data"
author: "Jack Miller, Namh Lahade, Matthew Paul, Caspian Svenson"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Load Packages

```{r load packages, warning = FALSE, message=FALSE}
library(tidyverse)
library(tidyr)
library(readr)
library(dplyr)
library(broom)
library(knitr)
library(nflfastR)
library(nflplotR)
library(ggrepel)
```

### Load PFF Data

```{r load PFF data}
stats_2014 <- read.csv("data_pff_receiver/2014_receiver_pff_data.csv") %>% 
  select(-c(avg_depth_of_target, avoided_tackles, contested_catch_rate, 
            contested_receptions, contested_targets, declined_penalties, 
            franchise_id, fumbles, grades_pass_block, inline_rate, inline_snaps,
            interceptions, longest, pass_block_rate, pass_blocks, penalties, 
            slot_rate, slot_snaps, wide_rate, wide_snaps))
stats_2015 <- read.csv("data_pff_receiver/2015_receiver_pff_data.csv") %>% 
  select(-c(avg_depth_of_target, avoided_tackles, contested_catch_rate, 
            contested_receptions, contested_targets, declined_penalties, 
            franchise_id, fumbles, grades_pass_block, inline_rate, inline_snaps,
            interceptions, longest, pass_block_rate, pass_blocks, penalties, 
            slot_rate, slot_snaps, wide_rate, wide_snaps))
stats_2016 <- read.csv("data_pff_receiver/2016_receiver_pff_data.csv") %>% 
  select(-c(avg_depth_of_target, avoided_tackles, contested_catch_rate, 
            contested_receptions, contested_targets, declined_penalties, 
            franchise_id, fumbles, grades_pass_block, inline_rate, inline_snaps,
            interceptions, longest, pass_block_rate, pass_blocks, penalties, 
            slot_rate, slot_snaps, wide_rate, wide_snaps))
stats_2017 <- read.csv("data_pff_receiver/2017_receiver_pff_data.csv") %>% 
  select(-c(avg_depth_of_target, avoided_tackles, contested_catch_rate, 
            contested_receptions, contested_targets, declined_penalties, 
            franchise_id, fumbles, grades_pass_block, inline_rate, inline_snaps,
            interceptions, longest, pass_block_rate, pass_blocks, penalties, 
            slot_rate, slot_snaps, wide_rate, wide_snaps))
stats_2018 <- read.csv("data_pff_receiver/2018_receiver_pff_data.csv") %>% 
  select(-c(avg_depth_of_target, avoided_tackles, contested_catch_rate, 
            contested_receptions, contested_targets, declined_penalties,
            franchise_id, fumbles, grades_pass_block, inline_rate, inline_snaps,
            interceptions, longest, pass_block_rate, pass_blocks, penalties, 
            slot_rate, slot_snaps, wide_rate, wide_snaps))
stats_2019 <- read.csv("data_pff_receiver/2019_receiver_pff_data.csv") %>% 
  select(-c(avg_depth_of_target, avoided_tackles, contested_catch_rate, 
            contested_receptions, contested_targets, declined_penalties, 
            franchise_id, fumbles, grades_pass_block, inline_rate, inline_snaps,
            interceptions, longest, pass_block_rate, pass_blocks, penalties, 
            slot_rate, slot_snaps, wide_rate, wide_snaps))
stats_2020 <- read.csv("data_pff_receiver/2020_receiver_pff_data.csv") %>% 
  select(-c(avg_depth_of_target, avoided_tackles, contested_catch_rate, 
            contested_receptions, contested_targets, declined_penalties, 
            franchise_id, fumbles, grades_pass_block, inline_rate, inline_snaps,
            interceptions, longest, pass_block_rate, pass_blocks, penalties, 
            slot_rate, slot_snaps, wide_rate, wide_snaps))
combine_stats <- read.csv("combinedStats.csv")
```

### Stats by Draft Classes

```{r players by draft class}
#2020 Stats of 2021 DC
dc_2021 <- c("Ja'Marr Chase", "DeVonta Smith" , "Elijah Moore" , "Dax Milne",
             "Jaelon Darden" , "Austin Trammell" , "Marlon Williams" , 
             "Tim Jones" , "Tylan Wallace" ,"D'Wayne Eskridge" ,
             "Jonathan Adams Jr." , "Kadarius Toney" , "Jaylen Waddle" , 
             "Antonio Nunn" , "Dyami Brown" , "Rashod Bateman",
             "Terrace Marshall Jr." , "Shi Smith" , "Amari Rodgers" , "Rondale Moore" ,
             "Isaiah McKoy" , "Damon Hazelton" , "Camden Harrison" , "Brevin Jordan" ,
             "Bailey Gaither" , "Tutu Atwell" , "Dez Fitzpatrick" , "Austin Watkins" ,
             "Simi Fehoko" , "Connor Wedington" , "Kawaan Baker" , "Cornell Powell" ,
             "Blake Proehl" , "Javon McKinley" , "Dazz Newsome" , "Landen Akers" ,
             "Tre Walker" , "Amon-Ra St. Brown" , "Eli Stove" , "Ramaud Chiaokhiao-Bowman" ,
             "Josh Palmer" , "Anthony Schwartz" , "Whop Philyor" , "Damonte Coxie" ,
             "Tray Eafford" , "Brennan Eagles" , "Trevon Grimes" , "Myron Mitchell" ,
             "Marquez Stevenson" , "Adrian Hardy" , "Seth Williams" , "Tre Odoms-Dukes" ,
             "Tyler Vaughns" , "Antwan Davis" , "Dillon Stoner" , "Josh Imatorbhebhe" ,
             "Tamorrion Terry" , "T.J. Simmons" , "DJ Turner" , "Tarik Black" ,
             "Tre Nixon" , "Sam Denmark" , "Jalen Camp" , "Ihmir Smith-Marsette" ,
             "Osirus Mitchell" , "Bennett Skowronek" , "Terrell Jana" , "Khalil McClain" ,
             "Jeremiah Haydel" , "T.J. Vasher" , "Riley Lees" , "Jacob Harris" ,
             "Racey McMath" , "Rico Bussey Jr." , "Branden Mack" , "Brandon Smith" ,
             "Frank Darby" , "Javon Turner" , "Adam Krumholz")

dc2021_stats2020 <- stats_2020 %>% 
  filter(player %in% dc_2021 & position == "WR") %>% 
  left_join(stats_2019, by = c("player", "player_id", "position"), 
            suffix = c("_draft", "_pre")) |>
  rowwise() %>% 
  mutate(total_yards = yards_draft + yards_pre,
         total_catch_percent = sum(c(receptions_draft + receptions_pre), na.rm=TRUE) / sum(c(targets_draft + targets_pre),
                                                                                           na.rm = TRUE),
         total_target_percent = sum(c(targets_draft + targets_pre), na.rm = TRUE) / sum(c(routes_draft + routes_pre), 
                                                                                        na.rm = TRUE),
         total_route_percent = sum(c(routes_draft + routes_pre), na.rm = TRUE) / sum(c(pass_plays_draft + pass_plays_pre),
                                                                                     na.rm = TRUE),
         total_drop_percent = sum(c(drops_draft+drops_pre), na.rm = TRUE) / sum(c(targets_draft+targets_pre), na.rm = TRUE),
         total_yprr = yprr_draft + yprr_pre,
         total_first_downs = sum(c(first_downs_draft+first_downs_pre), na.rm = TRUE),
         total_yards_per_reception = sum(c(yards_per_reception_draft+yards_per_reception_pre), na.rm = TRUE),
         total_yards_after_catch_per_reception = sum(c(yards_after_catch_per_reception_draft+
                                                       yards_after_catch_per_reception_pre), na.rm = TRUE),
         total_player_game_count = sum(c(player_game_count_draft+player_game_count_pre), na.rm = TRUE),
         total_touchdowns = sum(c(touchdowns_draft+touchdowns_pre), na.rm = TRUE),
         total_yards_per_game = ((sum(c(yards_draft,yards_pre), na.rm = TRUE)) / total_player_game_count), 
         total_yards_after_catch_per_game = ((sum(c(yards_after_catch_draft+ yards_after_catch_pre), na.rm = TRUE)) /
                                               total_player_game_count), 
         total_targets_per_game = ((sum(c(targets_draft+targets_pre), na.rm = TRUE)) / total_player_game_count), 
         total_targeted_qb_rating = sum(c(targeted_qb_rating_draft+targeted_qb_rating_pre), na.rm = TRUE) / 2,
         games_draft = (player_game_count_draft / sum(c(player_game_count_draft+ player_game_count_pre), na.rm = TRUE)),
         grades_hands_drop = sum(c((games_draft*grades_hands_drop_draft),((1-games_draft)*grades_hands_drop_pre)), 
                                 na.rm = TRUE),
         grades_hands_fumble = sum(c((games_draft*grades_hands_fumble_draft)+((1-games_draft)*grades_hands_fumble_pre)),
                                   na.rm = TRUE),
         grades_offense = sum(c((games_draft*grades_offense_draft)+((1-games_draft)*grades_offense_pre)), na.rm = TRUE),
         grades_pass_route = sum(c((games_draft*grades_pass_route_draft)+((1-games_draft)*grades_pass_route_pre)), 
                                 na.rm = TRUE))
pro_2022 <- read_csv("data/2022_pro_stats.csv")
pro_2021 <- read_csv("data/2021_pro_stats.csv")
dc_2021_pro_stats <- pro_2021 %>% 
  inner_join(pro_2022, by = c("player", "position", "player_id"), suffix = c("1yr", "2yr")) %>% 
  select(-c(grades_pass_block1yr, grades_pass_block2yr)) |>
  rowwise() %>% 
  mutate(total_yards = yards1yr + yards2yr,
         total_catch_percent = sum(c(receptions1yr + receptions2yr), na.rm=TRUE) / sum(c(targets1yr + targets2yr),
                                                                                           na.rm = TRUE),
         total_target_percent = sum(c(targets1yr + targets2yr), na.rm = TRUE) / sum(c(routes1yr + routes2yr), 
                                                                                        na.rm = TRUE),
         total_route_percent = sum(c(routes1yr + routes2yr), na.rm = TRUE) / sum(c(pass_plays1yr + pass_plays2yr),
                                                                                     na.rm = TRUE),
         total_drop_percent = sum(c(drops1yr+drops2yr), na.rm = TRUE) / sum(c(targets1yr+targets2yr), na.rm = TRUE),
         total_yprr = yprr1yr + yprr2yr,
         total_first_downs = sum(c(first_downs1yr+first_downs2yr), na.rm = TRUE),
         total_yards_per_reception = sum(c(yards_per_reception1yr+yards_per_reception2yr), na.rm = TRUE),
         total_yards_after_catch_per_reception = sum(c(yards_after_catch_per_reception1yr+
                                                       yards_after_catch_per_reception2yr), na.rm = TRUE),
         total_player_game_count = sum(c(player_game_count1yr+player_game_count2yr), na.rm = TRUE),
         total_touchdowns = sum(c(touchdowns1yr+touchdowns2yr), na.rm = TRUE),
         total_yards_per_game = sum(c(yards1yr+yards2yr), na.rm = TRUE) / total_player_game_count, 
         total_yards_after_catch_per_game = sum(c(yards_after_catch1yr + yards_after_catch2yr), na.rm = TRUE) /
                                               total_player_game_count,
         total_targets_per_game = sum(c(targets1yr + targets2yr), na.rm = TRUE) / total_player_game_count, 
         total_targeted_qb_rating = sum(c(targeted_qb_rating1yr+targeted_qb_rating2yr), na.rm = TRUE) / 2,
         games2yr = (player_game_count2yr / sum(c(player_game_count2yr + player_game_count1yr), na.rm = TRUE)),
         grades_hands_drop = sum(c((games2yr*grades_hands_drop2yr)+((1-games2yr)*grades_hands_drop1yr)), 
                                 na.rm = TRUE),
         grades_hands_fumble = sum(c((games2yr*grades_hands_fumble2yr)+((1-games2yr)*grades_hands_fumble1yr)),
                                   na.rm = TRUE),
         grades_offense = sum(c((games2yr*grades_offense2yr)+((1-games2yr)*grades_offense1yr)), na.rm = TRUE),
         grades_pass_route = sum(c((games2yr*grades_pass_route2yr)+((1-games2yr)*grades_pass_route1yr)), 
                                 na.rm = TRUE))
#2019 Stats of 2020 DC
dc_2020 <- c("Geraud Sanders" , "Tyler Johnson" , "CeeDee Lamb" , "Tee Higgins" ,
             "Isaiah Hodgins" , "Omar Bayless" , "Devin Duvernay" , "Jauan Jennings" ,
             "Antonio Gandy-Golden", "Ja'Marcus Bradley" , "James Proche" , 
             "Jerry Jeudy" , "Justin Jefferson" , "Laviska Shenault Jr." , 
             "Quintez Cephus" , "Brandon Arconado" , "Lawrence Cager" , 
             "Denzel Mims" , "Chase Claypool" , "Michael Pittman Jr." , 
             "Gabriel Davis" , "Arthur Jackson III" , "Hasise Dubois" , "Brandon Aiyuk" ,
             "Bryan Edwards" , "Deangelo Antoine" , "Michael Lawrence" , 
             "Micah Simon" , "Deshaunte Jones" , "Raghib Ismail Jr." , "Kendall Hinton" ,
             "Binjimen Victor" , "Tony Brown" , "Lucky Jackson" , "Cody White" ,
             "Elijah Robinson" , "Collin Johnson" , "Easop Winston Jr." , 
             "Freddie Swain" , "Quez Watkins" , "Antonio Gibson" , "Henry Ruggs III" ,
             "Siaosi Mariner" , "Darrell Stewart Jr." , "Trishton Jackson" , 
             "Demetrius Davis" , "John Hightower" , "Austin Mack" , "Aaron Fuller" ,
             "Malik Stanley" , "K.J. Hill" , "Dezmon Patmon" , "Pace Ozmint" , 
             "Kirk Merritt" , "Maurice Ffrench" , "Joe Reed" , "Jordan Mitchell" ,
             "K.J. Hamler" , "George Campbell" , "Jeff Thomas" , "Van Jefferson" ,
             "Darnell Mooney" , "Riley Miller" , "Kalija Lipscomb" , "Jason-Matthew Sharsh" ,
             "Donovan Peoples-Jones" , "Marquez Callaway" , "Hutch White" , 
             "Quartney Davis" , "Kumoku Noa" , "Q' Drennan" , "Tony Nicholson" ,
             "Deddrick Thomas" , "Dalton Schoen" , "Scotty Washington" , 
             "Ardell Brown" , "Derrick Vickers" , "Devin Gentry" , "Tony Gaiter IV" ,
             "Weston Carr" , "Bryan Long Jr." , "Mark Michaud" , "Jalen McCleskey" ,
             "Tyler Tupa" , "Josh Hammond" , "Jalen Reagor" , "Daylon Charlot" ,
             "Talon Shumway" , "La'Michael Pettway" , "JoJo Ward" , "Aaron Molina" ,
             "Camryn Snow" , "Kendall Parham" , "RJ Turner" , "Damian King" , 
             "Nick Basquine" , "Austin Maloney" , "Keith Mixon Jr." , "Chico McClatcher"
             , "Aleva Hifo" , "Ben Putman" , "Donavan Hale" , "Phil Patterson" ,
             "Mathew Sexton" , "Tyrie Cleveland" , "K.J. Osborn" , "Cedric Byrd II" ,
             "Austin Conway" , "Desmond Phillips" , "DL Knock" , "Lee Morris" ,
             "CJ Sanders" , "Stephen Guidry" , "Markis McCray" , "Juwan Johnson" ,
             "Nick Westbrook-Ikhine" , "Brenden Fulton" , "Trevor Terry" , 
             "Alan Busey" , "Jarrod Jackson" , "Johnathon Johnson" , "Deondre Farrier" ,
             "Chris Finke" , "Derrick Dillon" , "Terrell Chatman" , "Jocquez Bruce" ,
             "Travon Williams" , "Mike Carrigan" , "A.J. Taylor" , "Derrion Grim" ,
             "Line Latu" , "Xavier Brown" , "Dante Cousart" , "Sadiq Palmer" , 
             "Diondre Overton" , "Kaleb Fossum" , "Joey Fields" , "James Brunson" ,
             "Demari Simpkins" , "Jair Hawkins-Anderson" , "Courtney Lark" , 
             "Tabari Hines" , "Isaiah Wright" , "Seth Dawkins" , "Ryan Newsome" , 
             "Tyler Byrd" , "Keenen Johnson" , "Alex Mussat" , "Rashad Medaris" , "OJ Clark" ,
             "Trenard Davis" , "Jordan McCray" , "Prince Taylor" , "Aaron Mathews" ,
             "Kavious Price" , "Cedric Peterson" ,
             "T'Qele Holmes" , "Maurice Alexander" , "Luke Mayock" , "Ky'Jon Tyler" ,
             "Isiah Upton" , "Izaiah Lottie" , "Ty Lee" , "Isaiah Zuber" , 
             "Blaze Moorhead" , "Mason Hays" , "A.D. Miller" , "Ahmad Wagner" , 
             "Chris Platt" , "Quin Jernighan" , "Darren Woods Jr." , "Kyle Williams" ,
             "Caleb Reams" , "Jordan Duncan" , "OJ Davis" , "Jonathan Nance" , 
             "Andre Bodden" , "Darveon Brown" , "Darrell Brown" , "Tyler Simmons" , 
             "Josh Anderson" , "John Humphrey" , "Thomas Vieira" , "Kevin Purlett" ,
             "Anu Somoye" , "Tavaris Harrison" , "Devante Peete" , "Kendrick Rogers" ,
             "Will Hastings" , "Drew Dan" , "Malik Dunner" , "Larry Collins Jr." ,
             "Christian Hayes" , "Simino Walden" , "Thomas Jackson" , 
             "Hasaan Patterson" , "Jay Jay Wilson" , "Steven Claude" , "Spencer Tears" ,
             "Stephen Sullivan" , "Kjetil Cline", "Dominic Christian" , 
             "RB Marlow III" , "Tre'Veon Hamilton" , "Keith Gavin" , "Myron Gailliard" ,
             "Eddie Daugherty" , "Colby Ransom" , "Andre Baccellia" , "Nick Szpor" ,
             "Neil McLaurin" , "Keishawn Watson" , "Devon Jackson" , "TreVontae Hights" ,
             "Malik Tyson" , "Akilian Butler" , "Marques Jones" , "Tavin Richardson" ,
             "Terry Mark" , "Ben Glines" , "Javonte Woodard" , "Mike Williams" ,
             "Justice Shelton-Mosley" , "DeAndre McNeal" , "Brendan O'Leary-Orange" ,
             "Chavis Dawkins" , "Brandon Sowards" , "Kanawai Noa" , "Sal Cannella" ,
             "Thomas Geddis" , "John Okwoli" , "Dejon Brissett" , "Sean Riley" ,
             "Jordan Wayne-Prather" , "Kavika Johnson" , "John Johnson" , 
             "Dan Chisena" , "Cameron Cole" , "Stanley Clerveaux" , "John Burt" ,
             "Christian Owens" , "Darrius Scott" , "Chaz Collins" , "Shea Holebrook Jr.")

dc2020_stats2019 <- stats_2019 %>% 
  filter(player %in% dc_2020 & position == "WR") %>% 
  left_join(stats_2018, by = c("player", "player_id", "position"), 
            suffix = c("_draft", "_pre")) |>
  rowwise() %>% 
  mutate(total_yards = yards_draft + yards_pre,
         total_catch_percent = sum(c(receptions_draft + receptions_pre), na.rm=TRUE) / sum(c(targets_draft + targets_pre),
                                                                                           na.rm = TRUE),
         total_target_percent = sum(c(targets_draft + targets_pre), na.rm = TRUE) / sum(c(routes_draft + routes_pre), 
                                                                                        na.rm = TRUE),
         total_route_percent = sum(c(routes_draft + routes_pre), na.rm = TRUE) / sum(c(pass_plays_draft + pass_plays_pre),
                                                                                     na.rm = TRUE),
         total_drop_percent = sum(c(drops_draft+drops_pre), na.rm = TRUE) / sum(c(targets_draft+targets_pre), na.rm = TRUE),
         total_yprr = yprr_draft + yprr_pre,
         total_first_downs = sum(c(first_downs_draft+first_downs_pre), na.rm = TRUE),
         total_yards_per_reception = sum(c(yards_per_reception_draft+yards_per_reception_pre), na.rm = TRUE),
         total_yards_after_catch_per_reception = sum(c(yards_after_catch_per_reception_draft+
                                                       yards_after_catch_per_reception_pre), na.rm = TRUE),
         total_player_game_count = sum(c(player_game_count_draft+player_game_count_pre), na.rm = TRUE),
         total_touchdowns = sum(c(touchdowns_draft+touchdowns_pre), na.rm = TRUE),
         total_yards_per_game = ((sum(c(yards_draft,yards_pre), na.rm = TRUE)) / total_player_game_count), 
         total_yards_after_catch_per_game = ((sum(c(yards_after_catch_draft+ yards_after_catch_pre), na.rm = TRUE)) /
                                               total_player_game_count), 
         total_targets_per_game = ((sum(c(targets_draft+targets_pre), na.rm = TRUE)) / total_player_game_count), 
         total_targeted_qb_rating = sum(c(targeted_qb_rating_draft+targeted_qb_rating_pre), na.rm = TRUE) / 2,
         games_draft = (player_game_count_draft / sum(c(player_game_count_draft+ player_game_count_pre), na.rm = TRUE)),
         grades_hands_drop = sum(c((games_draft*grades_hands_drop_draft),((1-games_draft)*grades_hands_drop_pre)), 
                                 na.rm = TRUE),
         grades_hands_fumble = sum(c((games_draft*grades_hands_fumble_draft)+((1-games_draft)*grades_hands_fumble_pre)),
                                   na.rm = TRUE),
         grades_offense = sum(c((games_draft*grades_offense_draft)+((1-games_draft)*grades_offense_pre)), na.rm = TRUE),
         grades_pass_route = sum(c((games_draft*grades_pass_route_draft)+((1-games_draft)*grades_pass_route_pre)), 
                                 na.rm = TRUE))
pro_2020 <- read_csv("data/2020_pro_stats.csv")
dc_2020_pro_stats <- pro_2020 %>% 
  inner_join(pro_2021, by = c("player", "position", "player_id"), suffix = c("1yr", "2yr"))
dc_2020_stats <- inner_join(dc_2020_pro_stats, dc2020_stats2019, by = c("player_id", "player", "position")) %>% 
  select(-c(grades_pass_block1yr, grades_pass_block2yr)) |>
  rowwise() %>% 
  mutate(total_yards = yards1yr + yards2yr,
         total_catch_percent = sum(c(receptions1yr + receptions2yr), na.rm=TRUE) / sum(c(targets1yr + targets2yr),
                                                                                           na.rm = TRUE),
         total_target_percent = sum(c(targets1yr + targets2yr), na.rm = TRUE) / sum(c(routes1yr + routes2yr), 
                                                                                        na.rm = TRUE),
         total_route_percent = sum(c(routes1yr + routes2yr), na.rm = TRUE) / sum(c(pass_plays1yr + pass_plays2yr),
                                                                                     na.rm = TRUE),
         total_drop_percent = sum(c(drops1yr+drops2yr), na.rm = TRUE) / sum(c(targets1yr+targets2yr), na.rm = TRUE),
         total_yprr = yprr1yr + yprr2yr,
         total_first_downs = sum(c(first_downs1yr+first_downs2yr), na.rm = TRUE),
         total_yards_per_reception = sum(c(yards_per_reception1yr+yards_per_reception2yr), na.rm = TRUE),
         total_yards_after_catch_per_reception = sum(c(yards_after_catch_per_reception1yr+
                                                       yards_after_catch_per_reception2yr), na.rm = TRUE),
         total_player_game_count = sum(c(player_game_count1yr+player_game_count2yr), na.rm = TRUE),
         total_touchdowns = sum(c(touchdowns1yr+touchdowns2yr), na.rm = TRUE),
         total_yards_per_game = sum(c(yards1yr+yards2yr), na.rm = TRUE) / total_player_game_count, 
         total_yards_after_catch_per_game = sum(c(yards_after_catch1yr + yards_after_catch2yr), na.rm = TRUE) /
                                               total_player_game_count,
         total_targets_per_game = sum(c(targets1yr + targets2yr), na.rm = TRUE) / total_player_game_count, 
         total_targeted_qb_rating = sum(c(targeted_qb_rating1yr+targeted_qb_rating2yr), na.rm = TRUE) / 2,
         games2yr = (player_game_count2yr / sum(c(player_game_count2yr + player_game_count1yr), na.rm = TRUE)),
         grades_hands_drop = sum(c((games2yr*grades_hands_drop2yr)+((1-games2yr)*grades_hands_drop1yr)), 
                                 na.rm = TRUE),
         grades_hands_fumble = sum(c((games2yr*grades_hands_fumble2yr)+((1-games2yr)*grades_hands_fumble1yr)),
                                   na.rm = TRUE),
         grades_offense = sum(c((games2yr*grades_offense2yr)+((1-games2yr)*grades_offense1yr)), na.rm = TRUE),
         grades_pass_route = sum(c((games2yr*grades_pass_route2yr)+((1-games2yr)*grades_pass_route1yr)), 
                                 na.rm = TRUE))

#2018 Stats of 2019 DC
dc_2019 <- c("Andy Isabella" , "J.J. Arcega-Whiteside" , "Greg Dortch" , "Parris Campbell" ,
             "N'Keal Harry" , "Marquise Brown" , "Jakobi Meyers" , "Emanuel Hall" , 
             "Damion Willis" , "KeeSean Johnson" , "Anthony Johnson" , 
             "Kelvin Harmon" , "Preston Williams" , "Scotty Miller" , "Lil'Jordan Humphrey" ,
             "Antoine Wesley" , "Gary Jennings" , "Olamide Zaccheaus" , "Hakeem Butler" ,
             "Papi White" , "Dillon Mitchell" , "Deebo Samuel" , "Shawn Poindexter" ,
             "C.J. Worton" , "A.J. Brown" , "Travis Fulgham" , "Jovon Durante" ,
             "Floyd Allen" , "Malcolm Williams" , "Miles Boykin" , "Xavier Ubosi" ,
             "Tyre Brady" , "Nyqwan Murray" , "Sean Modster" , "Delane Hart-Johnson" ,
             "Fred Trevillion" , "Ronald Cleveland" , "Jalen Hurd" , "Stanley Morgan Jr." ,
             "DaMarkus Lodge" , "Dominique Heath" , "A.J. Richardson" , "Riley Ridley" ,
             "Jamarius Way" , "Collin Lisa" , "Andre Wilson" , "Olabisi Johnson" ,
             "Kahlil Lewis" , "Taylor Jackson" , "Reggie Turner" , "Trenton Irwin" ,
             "Trevon Brown" , "Shun Brown" , "Flynn Nagel" , "KaVontae Turpin" ,
             "D.K. Metcalf" , "Marcus Simms" , "Blake Banham" , "David Sills" ,
             "Felton Davis" , "Mike Dudek" , "Cody Thompson" , "Jonathan Duhart" ,
             "Earnest Patterson" , "Hunter Renfrow" , "Ja'Deion High" , "Aaren Vaughns" ,
             "Terry McLaurin" , "Mecole Hardman" , "Greg Campbell Jr." , "Terry Godwin II" ,
             "Ventell Bryant" , "Marcus Green" , "Diontae Johnson" , "John Ursua" , 
             "TJ Rahming" , "James Gardner" , "Kailon Carter" , "Jon'Vea Johnson" , 
             "Cudjoe Young" , "Penny Hart" , "Ron'Quavion Tarver" , "Brodrick Yancy" ,
             "Zach Abey" , "Dredrick Snelson" , "Deondre Douglas" , "Timmy Hernandez" ,
             "Justin McInnis" , "Jamal Custis" , "Brad Stewart" , "Tyron Johnson" ,
             "Nick Easley" , "Teddy Veal" , "Warren Redix" , "Anthony Ratliff-Williams" ,
             "Michael Walker" , "Terren Encalade" , "Ryheem Malone" , "Jalen Greene" ,
             "Andrew Smith" , "Steven Sims" , "DJ Nelson" , "Luke Timian" ,
             "Jalen Guyton" , "Alex Bachman" , "B.J. Farrow" , "Ryan Davis" , 
             "Devon Spalding" , "Kwadarrius Smith" , "Thai Cottrell" , "Deric Phouthavong" ,
             "Tyre McCants" , "Juwann Winfree" , "Jahmmir Taylor" , "Dylan Collie" , 
             "Andrew Meyer" , "Jake Matkovich" , "Johnnie Dixon" , "Patrick Smith" ,
             "Raelon Singleton" , "Rafael Araujo-Lopes" , "Alex Weber" , "David Bouvier" ,
             "Tony Ellison" , "Johnathan Boone" , "Jaylen Smith" , "Terry Wright" , 
             "J-Shun Harris II" , "Darius Slayton" , "Marquez McNair" , "Hergy Mayala" ,
             "Jauan Wesley" , "Sidney Davis" , "Isaac Zico" , "D.J. Brown" , 
             "Taivon Jacobs" , "Tre Hartley" , "Corey Lacanaria" , "Derek Kief" ,
             "Kelton Powell" , "Devan Stubblefield" , "Tyler Watts" , "Kerr Johnson Jr." ,
             "D'Marius Gillespie" , "Ryeshene Bronson" , "Marcus Armstrong-Brown" ,
             "Erik Brown" , "Jelani Roberts" , "Vic Wharton III" , "Darrell Langham" ,
             "Terry Juniel" , "Matthew Eaton" , "James Price" , "Isaiah Harper" ,
             "Dre Massey" , "Trevion Thompson" , "Jeremiah Booker" , "Gatlin Casey" ,
             "Raekwon James" , "Stephen Louis" , "Austin Ahrendt" , "Justin Hobbs" ,
             "Justin Walker" , "Kabion Ento" , "Griffin King" , "Royce Caldwell" ,
             "Robert Lewis" , "Drake Harris" , "Johnathan Lloyd" , "Brad Absher" ,
             "Ahkil Crumpton" , "DeSean Holmes" , "Brian Newman" , "Grant Perry" ,
             "Moe Ways" , "Sam Mays" , "Ryan Jenkins" , "Michiah Quick" , "Jamire Jordan" ,
             "Sam Harris" , "Johnny Woods" , "Jameson Field" , "Marcel Williams" ,
             "Kinte Hatton" , "Dominique Maiden" , "Kyle Sweet" , "Terrell Green" ,
             "Jerrod Heard" , "Jarrison Stewart" , "Namani Parker" , "Jeff Smith" ,
             "Justin Holmes" , "Jabril Clewis" , "Kyle Buss" , "Tristan Payton" ,
             "Patrick Reed" , "Zach Austin" , "Chris Taylor" , "Kendrick Edwards" ,
             "Trevon Lee" , "Jayson Stanley" , "Sam Craft" , "Myles Tease" , "Jesse Jackson" ,
             "Tristin Kamaka" , "Emmanuel Harris" , "Trey Ellis" , "Kyle Groeneweg" ,
             "De'Quan Bowman" , "Jarrett Burgess" ,"Keyan Williams" , "Kendal Keys" ,
             "Christian Pabico" , "Mykel Traylor-Bennett" , "Quinetin Jackson" , 
             "Tavonn Salter" , "Zaquon Tyson" , "Justin Sawmiller" , "Jacoby Herring" ,
             "Jaelan Austin" , "Justin Allen" , "Dorian Baker" , "DeAndre Thompkins" ,
             "Bryan Reimers" , "Jay MacIntyre" , "Jahrvis Davenport" , "Jared Cornelius" ,
             "Nate Brown" , "Devin Reece" , "Zach Reuter" , "Dakota Torres" , 
             "George Rushing" , "Tyraiq Beals" , "Larry Stephens" , "Cam Stewart" ,
             "Ryan Schadler" , "Rafael Hidalgo" , "William Crest Jr." , "Brandon Mitchell" ,
             "Lemar Harris")

dc2019_stats2018 <- stats_2018 %>% 
  filter(player %in% dc_2019 & position == "WR") %>% 
  left_join(stats_2017, by = c("player", "player_id", "position"), 
            suffix = c("_draft", "_pre")) |>
  rowwise() %>% 
  mutate(total_yards = yards_draft + yards_pre,
         total_catch_percent = sum(c(receptions_draft + receptions_pre), na.rm=TRUE) / sum(c(targets_draft + targets_pre),
                                                                                           na.rm = TRUE),
         total_target_percent = sum(c(targets_draft + targets_pre), na.rm = TRUE) / sum(c(routes_draft + routes_pre), 
                                                                                        na.rm = TRUE),
         total_route_percent = sum(c(routes_draft + routes_pre), na.rm = TRUE) / sum(c(pass_plays_draft + pass_plays_pre),
                                                                                     na.rm = TRUE),
         total_drop_percent = sum(c(drops_draft+drops_pre), na.rm = TRUE) / sum(c(targets_draft+targets_pre), na.rm = TRUE),
         total_yprr = yprr_draft + yprr_pre,
         total_first_downs = sum(c(first_downs_draft+first_downs_pre), na.rm = TRUE),
         total_yards_per_reception = sum(c(yards_per_reception_draft+yards_per_reception_pre), na.rm = TRUE),
         total_yards_after_catch_per_reception = sum(c(yards_after_catch_per_reception_draft+
                                                       yards_after_catch_per_reception_pre), na.rm = TRUE),
         total_player_game_count = sum(c(player_game_count_draft+player_game_count_pre), na.rm = TRUE),
         total_touchdowns = sum(c(touchdowns_draft+touchdowns_pre), na.rm = TRUE),
         total_yards_per_game = ((sum(c(yards_draft,yards_pre), na.rm = TRUE)) / total_player_game_count), 
         total_yards_after_catch_per_game = ((sum(c(yards_after_catch_draft+ yards_after_catch_pre), na.rm = TRUE)) /
                                               total_player_game_count), 
         total_targets_per_game = ((sum(c(targets_draft+targets_pre), na.rm = TRUE)) / total_player_game_count), 
         total_targeted_qb_rating = sum(c(targeted_qb_rating_draft+targeted_qb_rating_pre), na.rm = TRUE) / 2,
         games_draft = (player_game_count_draft / sum(c(player_game_count_draft+ player_game_count_pre), na.rm = TRUE)),
         grades_hands_drop = sum(c((games_draft*grades_hands_drop_draft),((1-games_draft)*grades_hands_drop_pre)), 
                                 na.rm = TRUE),
         grades_hands_fumble = sum(c((games_draft*grades_hands_fumble_draft)+((1-games_draft)*grades_hands_fumble_pre)),
                                   na.rm = TRUE),
         grades_offense = sum(c((games_draft*grades_offense_draft)+((1-games_draft)*grades_offense_pre)), na.rm = TRUE),
         grades_pass_route = sum(c((games_draft*grades_pass_route_draft)+((1-games_draft)*grades_pass_route_pre)), 
                                 na.rm = TRUE))


pro_2019 <- read_csv("data/2019_pro_stats.csv")
dc_2019_pro_stats <- pro_2019 %>% 
  inner_join(pro_2020, by = c("player", "position", "player_id"), suffix = c("1yr", "2yr"))
dc_2019_stats <- inner_join(dc_2019_pro_stats, dc2019_stats2018, by = c("player_id", "player", "position")) %>% 
  select(-c(grades_pass_block1yr, grades_pass_block2yr)) |>
  rowwise() %>% 
  mutate(total_yards = yards1yr + yards2yr,
         total_catch_percent = sum(c(receptions1yr + receptions2yr), na.rm=TRUE) / sum(c(targets1yr + targets2yr),
                                                                                           na.rm = TRUE),
         total_target_percent = sum(c(targets1yr + targets2yr), na.rm = TRUE) / sum(c(routes1yr + routes2yr), 
                                                                                        na.rm = TRUE),
         total_route_percent = sum(c(routes1yr + routes2yr), na.rm = TRUE) / sum(c(pass_plays1yr + pass_plays2yr),
                                                                                     na.rm = TRUE),
         total_drop_percent = sum(c(drops1yr+drops2yr), na.rm = TRUE) / sum(c(targets1yr+targets2yr), na.rm = TRUE),
         total_yprr = yprr1yr + yprr2yr,
         total_first_downs = sum(c(first_downs1yr+first_downs2yr), na.rm = TRUE),
         total_yards_per_reception = sum(c(yards_per_reception1yr+yards_per_reception2yr), na.rm = TRUE),
         total_yards_after_catch_per_reception = sum(c(yards_after_catch_per_reception1yr+
                                                       yards_after_catch_per_reception2yr), na.rm = TRUE),
         total_player_game_count = sum(c(player_game_count1yr+player_game_count2yr), na.rm = TRUE),
         total_touchdowns = sum(c(touchdowns1yr+touchdowns2yr), na.rm = TRUE),
         total_yards_per_game = sum(c(yards1yr+yards2yr), na.rm = TRUE) / total_player_game_count, 
         total_yards_after_catch_per_game = sum(c(yards_after_catch1yr + yards_after_catch2yr), na.rm = TRUE) /
                                               total_player_game_count,
         total_targets_per_game = sum(c(targets1yr + targets2yr), na.rm = TRUE) / total_player_game_count, 
         total_targeted_qb_rating = sum(c(targeted_qb_rating1yr+targeted_qb_rating2yr), na.rm = TRUE) / 2,
         games2yr = (player_game_count2yr / sum(c(player_game_count2yr + player_game_count1yr), na.rm = TRUE)),
         grades_hands_drop = sum(c((games2yr*grades_hands_drop2yr)+((1-games2yr)*grades_hands_drop1yr)), 
                                 na.rm = TRUE),
         grades_hands_fumble = sum(c((games2yr*grades_hands_fumble2yr)+((1-games2yr)*grades_hands_fumble1yr)),
                                   na.rm = TRUE),
         grades_offense = sum(c((games2yr*grades_offense2yr)+((1-games2yr)*grades_offense1yr)), na.rm = TRUE),
         grades_pass_route = sum(c((games2yr*grades_pass_route2yr)+((1-games2yr)*grades_pass_route1yr)), 
                                 na.rm = TRUE))
#2017 Stats of 2018 DC
dc_2018 <- c("Michael Gallup" , "Trey Quinn" , "Cedrick Wilson" , "Anthony Miller" ,
             "Marcell Ateman" , "Thomas Owens" , "James Washington" , "Cam Phillips" ,
             "Keke Coutee" , "Mikah Holder" , "Deontay Burnett" , "Jordan Lasley" ,
             "Ricky Jeune" , "Darren Carrington II" , "D.J. Moore" , "Linell Bonner" ,
             "Keith Kirkwood" , "Alfonso Onunwor" , "Tre'Quan Smith" , "Teo Redding" ,
             "Kylen Towner" , "Dante Pettis" , "Ike Lewis" , "D.J. Chark Jr." , 
             "Korey Robertson" , "Allen Lazard" , "J'Mon Moore" , "Calvin Ridley" ,
             "Christian Kirk" , "Steve Ishmael" , "DaeSean Hamilton" , "Jeff Badet" ,
             "Tyler Carmona" , "Kalib Woods" , "Javon Wims" , "Courtland Sutton" ,
             "Trent Sherfield" , "Davon Grayson" , "Sergio Bailey II" , "Tyrell Johnson" ,
             "Jaleel Scott" , "Armanti Foreman" , "Auden Tate" , "Steven Mitchell Jr." ,
             "Steven Dunbar Jr." , "Ermon Lane" , "Tavares Martin Jr." , "Cam Echols-Luper" ,
             "Deon Cain" , "Darren Andrews" , "Austin Proehl" , "Nacarius Fant" ,
             "Trever Ryen" , "Turner Smiley" , "De'Mornay Pierson-El" , "Dylan Cantrell" ,
             "Brandon Powell" , "Elijah King" , "Braxton Berrios" , "Charlie Callinan" ,
             "Antoine Porter" , "Kerry Thomas Jr." , "Sa'Mory Collier" , "Devonte Boyd" ,
             "Mark Chapman" , "Christian Booker" , "Marquez Valdes-Scantling" ,
             "Equanimeous St. Brown" , "Zy Letman" , "Bryce Bobo" , "Chad Beebe" ,
             "Jacob Sannon" , "Anthony Mahoungou" , "Wyatt Demps" , "Detrich Clark" ,
             "Trey Smith" , "Justin Motlow" , "Russell Gage" , "Jerrid Marhefka" , 
             "Brendan Cope" , "Garrett Johnson" , "JaQuay Savage" , "Ka'Raun White" ,
             "Ervin Philips" , "Workpeh Kofa" , "Jacob Martinez" , "Damion Ratley" ,
             "Tyler Jaynes" , "Corey Willis" , "Richie James Jr." , "Desmon White" ,
             "Jimmy Williams" , "Jordan Veasy" , "Simmie Cobbs" , "Josh Stewart" ,
             "Janarion Grant" , "John Diarse" , "Emanuel Thompson" , "Jermaine Adams" ,
             "Andre Levrone" , "Pete Norris" , "Julian Williams" , "Adonis Jennings" ,
             "Chris Murray" , "Charles Nelson" , "Phil Mayhue" , "Sean Avant" ,
             "Jojo Robinson" , "Jared Murphy" , "Da'Mari Scott" , "Chris Davis Jr." ,
             "Javonte Bagley" , "Tevaris McCormick" , "Tra'Von Chapman" , "A.J. Coney" ,
             "Jester Weah" , "Alejandro Marenco III" , "C.J. Duncan" , "Charles Walker" ,
             "Austin Wolf" , "John Leday" , "Tyler Batson" , "Devin Gray" , 
             "Byron Pringle" , "Taj Williams" , "Gabe Myles" , "Allenzae Staggers" ,
             "Liam Allen" , "Chris Lacy" , "Kamathi Holsey" , "Jordan Hogue" ,
             "Josh Aganon" , "Blake Bone" , "Conner Cramer" , "Ellis Jefferson" ,
             "James Clark" , "Will Reger" , "Quay Johnson" , "Lance Wright" ,
             "Marques Little" , "Jeff George" , "Ray-Ray McCloud III" , "Malik Turner" ,
             "John Johnson" , "Jordan Cunningham" , "Jordan Villamin" , "Dorian Leonard" ,
             "Kayaune Ross" , "Shay Fields" , "Fransohn Bickley" , "Derek McLemore" ,
             "Chris Montgomery" , "Glenn Smith" , "Reuben Mwehla" , "Hyleck Foster" ,
             "Cam Sims" , "Dijon Paschal" , "Cameron Batson" , "Temi Alaka" , 
             "Ammon Barker" , "Doni Dowling" , "Braelon Roberts" , "Quest Truxton" ,
             "Johnnie Niupalau" , "Marchie Murdock" , "John Franklin III" , 
             "Mark Quattlebaum" , "Jumichael Ramos" , "Saeed Blacknall" , "Caleb Scott" ,
             "Jeff Ejekam" , "Derrick Willies" , "Sam Martin" , "Cody Hodgens" ,
             "Kyle Fulks" , "Uriah LeMay" , "Trent Bostick" , "Jordan Smallwood" ,
             "Jonah Trinnaman" , "KE'Marvin Pitts" , "Dominic Collins" , 
             "Quadree Henderson" , "Cam Denson" , "Chase Whitehead" , "Ty Slanina" ,
             "Donald Gray" , "Gregory Phillips" , "Dannon Cavil" , "CJ Dimry" , 
             "Matt VandeBerg" , "Jack Swinney" , "Isaiah Bernard" , "Bobby Mitchell" ,
             "Parker Smith" , "Ben Olinger" , "Dalton Ponchillia" , "Alex Byers" ,
             "Kamrin Solomon" , "Brandon Mitchell" , "Brandon Colon")

dc_2018_2 <- c("Jaron Johnson" , "Austin Parker" , "Jeffery Mead" , "Brady Jones" ,
               "Marlon Watts" , "Macan Wilson" , "Bryan LaCivita" , "Eldridge Massington" ,
               "Dante Jones" , "Tristan Davis" , "Devin Ross" , "Donovan Walker" ,
               "Xavier Hawkins" , "Jamarl Eiland" , "Clark Quisenberry" , 
               "Marcus Gaines" , "Tucker Melcher" , "Roderick Proctor" , "Markell Pack",
               "Eric Cooper" , "Eric Luna" , "Quay Chambers" , "Darryl Richards" ,
               "Anthony Young" , "Keelan Ewaliko" , "Alex Van Dyke" , "Cameron Smith" ,
               "Gregory Hogan" , "T.L. Ford II" , "Damon Mitchell" , "Trevor Steinke" ,
               "Nigel Carter" , "Gabe Rahn" , "Christian Blake" , "Ricky Rogers" ,
               "Kevin Gladney" , "Jaren Colston-Green" , "Myles Campbell" , 
               "Gary Bradshaw" , "Emanuel Porter" , "Lorenzo Joe" , "Josh Smith" , 
               "Thadd Smith" , "DeJuawn Oliver" , "Kris White" , "Craig Scott" , 
               "Jared Jackson" , "Todd Boyd" , "Gavin Locklear" , "Freddy Canteen" ,
               "Isaiah Jones" , "Devin Scott" , "Eric Carter" , "Nate Terry" , 
               "Robert Foster" , "Henry Bussey III" , "Jazz Peavy" , "Kendrick Dorn" ,
               "Shelby Walker" , "Jacquille Veii")

dc2018_stats2017 <- stats_2017 %>% 
  filter(player %in% dc_2018 | player %in% dc_2018_2 & position == "WR") %>% 
  left_join(stats_2016, by = c("player", "player_id", "position"), 
            suffix = c("_draft", "_pre")) |>
  rowwise() %>% 
  mutate(total_yards = yards_draft + yards_pre,
         total_catch_percent = sum(c(receptions_draft + receptions_pre), na.rm=TRUE) / sum(c(targets_draft + targets_pre),
                                                                                           na.rm = TRUE),
         total_target_percent = sum(c(targets_draft + targets_pre), na.rm = TRUE) / sum(c(routes_draft + routes_pre), 
                                                                                        na.rm = TRUE),
         total_route_percent = sum(c(routes_draft + routes_pre), na.rm = TRUE) / sum(c(pass_plays_draft + pass_plays_pre),
                                                                                     na.rm = TRUE),
         total_drop_percent = sum(c(drops_draft+drops_pre), na.rm = TRUE) / sum(c(targets_draft+targets_pre), na.rm = TRUE),
         total_yprr = yprr_draft + yprr_pre,
         total_first_downs = sum(c(first_downs_draft+first_downs_pre), na.rm = TRUE),
         total_yards_per_reception = sum(c(yards_per_reception_draft+yards_per_reception_pre), na.rm = TRUE),
         total_yards_after_catch_per_reception = sum(c(yards_after_catch_per_reception_draft+
                                                       yards_after_catch_per_reception_pre), na.rm = TRUE),
         total_player_game_count = sum(c(player_game_count_draft+player_game_count_pre), na.rm = TRUE),
         total_touchdowns = sum(c(touchdowns_draft+touchdowns_pre), na.rm = TRUE),
         total_yards_per_game = ((sum(c(yards_draft,yards_pre), na.rm = TRUE)) / total_player_game_count), 
         total_yards_after_catch_per_game = ((sum(c(yards_after_catch_draft+ yards_after_catch_pre), na.rm = TRUE)) /
                                               total_player_game_count), 
         total_targets_per_game = ((sum(c(targets_draft+targets_pre), na.rm = TRUE)) / total_player_game_count), 
         total_targeted_qb_rating = sum(c(targeted_qb_rating_draft+targeted_qb_rating_pre), na.rm = TRUE) / 2,
         games_draft = (player_game_count_draft / sum(c(player_game_count_draft+ player_game_count_pre), na.rm = TRUE)),
         grades_hands_drop = sum(c((games_draft*grades_hands_drop_draft),((1-games_draft)*grades_hands_drop_pre)), 
                                 na.rm = TRUE),
         grades_hands_fumble = sum(c((games_draft*grades_hands_fumble_draft)+((1-games_draft)*grades_hands_fumble_pre)),
                                   na.rm = TRUE),
         grades_offense = sum(c((games_draft*grades_offense_draft)+((1-games_draft)*grades_offense_pre)), na.rm = TRUE),
         grades_pass_route = sum(c((games_draft*grades_pass_route_draft)+((1-games_draft)*grades_pass_route_pre)), 
                                 na.rm = TRUE))

pro_2018 <- read_csv("data/2018_pro_stats.csv")
dc_2018_pro_stats <- pro_2018 %>% 
  inner_join(pro_2019, by = c("player", "position", "player_id"), suffix = c("1yr", "2yr"))
dc_2018_stats <- inner_join(dc_2018_pro_stats, dc2018_stats2017, by = c("player_id", "player", "position")) |>
  select(-c(grades_pass_block1yr, grades_pass_block2yr)) |>
  rowwise() %>% 
  mutate(total_yards = yards1yr + yards2yr,
         total_catch_percent = sum(c(receptions1yr + receptions2yr), na.rm=TRUE) / sum(c(targets1yr + targets2yr),
                                                                                           na.rm = TRUE),
         total_target_percent = sum(c(targets1yr + targets2yr), na.rm = TRUE) / sum(c(routes1yr + routes2yr), 
                                                                                        na.rm = TRUE),
         total_route_percent = sum(c(routes1yr + routes2yr), na.rm = TRUE) / sum(c(pass_plays1yr + pass_plays2yr),
                                                                                     na.rm = TRUE),
         total_drop_percent = sum(c(drops1yr+drops2yr), na.rm = TRUE) / sum(c(targets1yr+targets2yr), na.rm = TRUE),
         total_yprr = yprr1yr + yprr2yr,
         total_first_downs = sum(c(first_downs1yr+first_downs2yr), na.rm = TRUE),
         total_yards_per_reception = sum(c(yards_per_reception1yr+yards_per_reception2yr), na.rm = TRUE),
         total_yards_after_catch_per_reception = sum(c(yards_after_catch_per_reception1yr+
                                                       yards_after_catch_per_reception2yr), na.rm = TRUE),
         total_player_game_count = sum(c(player_game_count1yr+player_game_count2yr), na.rm = TRUE),
         total_touchdowns = sum(c(touchdowns1yr+touchdowns2yr), na.rm = TRUE),
         total_yards_per_game = sum(c(yards1yr+yards2yr), na.rm = TRUE) / total_player_game_count, 
         total_yards_after_catch_per_game = sum(c(yards_after_catch1yr + yards_after_catch2yr), na.rm = TRUE) /
                                               total_player_game_count,
         total_targets_per_game = sum(c(targets1yr + targets2yr), na.rm = TRUE) / total_player_game_count, 
         total_targeted_qb_rating = sum(c(targeted_qb_rating1yr+targeted_qb_rating2yr), na.rm = TRUE) / 2,
         games2yr = (player_game_count2yr / sum(c(player_game_count2yr + player_game_count1yr), na.rm = TRUE)),
         grades_hands_drop = sum(c((games2yr*grades_hands_drop2yr)+((1-games2yr)*grades_hands_drop1yr)), 
                                 na.rm = TRUE),
         grades_hands_fumble = sum(c((games2yr*grades_hands_fumble2yr)+((1-games2yr)*grades_hands_fumble1yr)),
                                   na.rm = TRUE),
         grades_offense = sum(c((games2yr*grades_offense2yr)+((1-games2yr)*grades_offense1yr)), na.rm = TRUE),
         grades_pass_route = sum(c((games2yr*grades_pass_route2yr)+((1-games2yr)*grades_pass_route1yr)), 
                                 na.rm = TRUE))
#2016 Stats of 2017 DC
dc_2017 <- c("Jalen Rowell","Austin Carr","Dede Westbrook","Mike Williams", 
             "Zay Jones","Carlos Henderson","Corey Davis", "Taywan Taylor" , 
             "Jamir Tillman" , "Tanner Gentry" , "Trent Taylor" , "John Ross" , 
             "Chad Hansen" , "Kenny Golladay" , "Jordan Westerkamp" , 
             "Nicholas Norris" , "Jordan Frysinger" , "Drew Wolitarsky" , 
             "Josh Reynolds" , "Thomas Sperbeck" , "Eugene Lewis" , 
             "Daikiel Shorts" , "Ryan Switzer" , "Noel Thomas" , "Isaiah Ford" , 
             "Isaiah McKenzie" , "Malachi Dupre" , "Keon Hatcher" , "Edgar Poe" , 
             "Zach Pascal" , "Amba Etta-Tawo" , "BJ Johnson III" , "Amara Darboh", 
             "R.J. Shelton" , "Marcus Kemp" , "KeVonn Mabon" , "Drew Morgan" , 
             "Josh Atkinson" , "Al-Damion Riles" , "Tim Patrick" , "Chris Godwin",
             "Sebastian Smith" , "K.D. Cannon" , "Josh Malone" , "Ricky Jones" , 
             "Fred Ross" , "Keevan Lucas" , "Tim Crawley" , "Noah Brown" , 
             "River Cracraft" , "Jerome Lane" , "ArDarius Stewart" , "Shelton Gibson" ,
             "Zach Yousey" , "Robert Davis" , "JuJu Smith-Schuster" , "Garrett Juergens" ,
             "Dameon Gamblin" , "Rodney Adams" , "Josh Magee" , "Stacy Coley" , 
             "Callen Hightower", "Bug Howard" , "Brandon Reilly" , "Tim White" , 
             "Dontre Wilson" , "Hasaan Henderson" , "Marcus McGill" , "Austin Duke",
             "Bobo Wilson" , "Darreus Rogers" , "Torii Hunter Jr." , "Travis Rudolph",
             "Kendall Sanders" , "Jacorey Warrick" , "Tony Stevens" , "Austin Hays",
             "Chance Allen" , "JoJo Natson" , "Cole Freytag" , "Gabe Marks" , 
             "Jhajuan Seales" , "Corey Jones" , "DeAndre Lane" , "Mitchell Paige" ,
             "Cory Butler-Byrd" , "Michael Henry" , "D.J. Thompson" , "Carrington Thompson",
             "Travin Dural" , "JaBryce Taylor" , "Damore'ea Stringfellow" , 
             "Artavis Scott" , "Montay Crockett" , "Nate Cole" , "Jordan Reid" , 
             "Jared Johnson" , "Nate Phillips" , "Jalen Williams" , "Dwayne Stanford" ,
             "Alonzo Moore" , "Kermit Whitfield" , "Chris Black" , "Devin Lauderdale" ,
             "Ahmad Fulwood" , "Temuchin Hodges" , "Teldrick Morgan" , "Michael Clark" ,
             "Dan Jonah" , "Mack Hollins" , "Robert Wheelwright" , "Riley McCarron" ,
             "Jared Mapps" , "Ishmael Adams" , "Jehu Chesson" , "Josh Knight" , 
             "Colby Pearson" , "Cody Hollister" , "Nick Kurtz" , "Ajalen Holley" ,
             "DeAngelo Yancey" , "Frederick Gammage" , "Demetrius Frazier")

dc_2017_2 <- c("Larry Dace III", "Stephon Brown","Anthony Nash","Jake Maulhardt",
               "Andrew Scanlan","Ishmael Zamora","D'Vario Montgomery",  "Domonique Young" ,
               "Shug Oyegunle" , "Aaron Peck" , "Deon-Tay McManus" , "Cywettnie Brown" ,
               "Levern Jacobs" , "Jamari Staples" , "Ryan Timmons" , "Robert Ruiz" ,
               "Eric Judge" , "Michael Rector" , "James Quick" , "Alvin Cornelius" ,
               "Marquise Ricard" , "Dominique Reed" , "Bernard Davis" , "Bug Rivera" ,
               "Malcolm Lewis" , "Dontez Ford" , "Deante Burton" , "Cameron Decell" ,
               "Mitchell Juergens" , "Tyler Cooperwood" , "De'Quan Hampton" , 
               "Drew Bishop" , "Justin Hunt" , "Speedy Noil" , "Rokeem Williams" , 
               "Andre Patton" , "Ernest Calhoun" , "Aregeros Turner" , "Kevin Davis" ,
               "Willie Robinson" , "Monty Madaris" , "Zach Wright" , "Charles Chandler" ,
               "Jesse Kroll" , "Thaddeous Thompson" , "Chris Lewis" , "Taylor Oldham" ,
               "Trey Griffey" , "Brisly Estime" , "Bra'Lon Cherry" , "Keeon Johnson" ,
               "Francis Owusu" , "Quincy Adeboyejo" , "Victor Bolden Jr." , "Andrew Rodriguez" ,
               "Bilal Marshall" , "Ronnie Moore" , "Tony Thomas" , "Ethan Cortazzo",
               "Tyrian Taylor" , "Zach Grant" , "Kendrick Mathis" , "Shawn Brickley",
               "Jeremy Tabuyo" , "Curtis Anderson III" , "Jarvis Baxter" , "Jarell Aaron" ,
               "Patrick Worstell" , "Darian Williams" , "Ricky Seals-Jones" , 
               "Ryan Smith" , "Boone Niederhofer" , "Justin Hardee" , 
               "Kevin Kutchera" , "Cameron Posey" , "Corey Smith" , "Kenneth Walker III"
               , "Tre' Perrier" , "Dondre Daley" , "Jaquan White" , "Austin Moses" 
               , "Chaz Anderson" , "Kenny Buyers" , "Isaac Whitney" , "Reggie Davis" 
               , "Grant Newell" , "Tyre'oune Holmes" , "Daniel Hurd" , "Deante Gray" 
               , "Reginald Davis III" , "Samajie Grant" , "Dennis Andrews" , "Alex Mut" 
               , "Austin Stewart" , "Kennedy Williams" , "Sterling Stowers" , 
               "Aaron Hepp" , "Jerico Richardson" , "Taijuan Thomas" , "Lynx Hawthorne"
               , "Fred Nixon" , "Rod Ducksworth" , "Hayden Jones" , "Tyrone Williams" 
               , "Keigan Williams" , "Brandon Bishop" , "Carlton Agudosi" , 
               "Shakiem Barbel" , "Gio Pascascio" , "Gehrig Dieter" , "Chris Thompson",
               "Edward Pope" , "Latevius Rayford" , "Malcolm Robinson" , 
               "Michael Martens", "Devon Breaux" , "Devonte Mathis" , "John Thompson",
               "Anthony Rice" , "Clayton Glasper" , "D.J. Taylor" , "Malcolm Culmer",
               "Sam Shisso" , "Marcus Davis" , "Eric Laurent" , "Jeffrey Coprich",
               "Brian Lemelle" , "Conner Smith" , "Darrion Pollard")

dc2017_stats2016 <- stats_2016 %>% 
  filter(player %in% dc_2017 | player %in% dc_2017_2 & position == "WR") %>% 
  left_join(stats_2015, by = c("player", "player_id", "position"), 
            suffix = c("_draft", "_pre")) |>
  rowwise() %>% 
  mutate(total_yards = yards_draft + yards_pre,
         total_catch_percent = sum(c(receptions_draft + receptions_pre), na.rm=TRUE) / sum(c(targets_draft + targets_pre),
                                                                                           na.rm = TRUE),
         total_target_percent = sum(c(targets_draft + targets_pre), na.rm = TRUE) / sum(c(routes_draft + routes_pre), 
                                                                                        na.rm = TRUE),
         total_route_percent = sum(c(routes_draft + routes_pre), na.rm = TRUE) / sum(c(pass_plays_draft + pass_plays_pre),
                                                                                     na.rm = TRUE),
         total_drop_percent = sum(c(drops_draft+drops_pre), na.rm = TRUE) / sum(c(targets_draft+targets_pre), na.rm = TRUE),
         total_yprr = yprr_draft + yprr_pre,
         total_first_downs = sum(c(first_downs_draft+first_downs_pre), na.rm = TRUE),
         total_yards_per_reception = sum(c(yards_per_reception_draft+yards_per_reception_pre), na.rm = TRUE),
         total_yards_after_catch_per_reception = sum(c(yards_after_catch_per_reception_draft+
                                                       yards_after_catch_per_reception_pre), na.rm = TRUE),
         total_player_game_count = sum(c(player_game_count_draft+player_game_count_pre), na.rm = TRUE),
         total_touchdowns = sum(c(touchdowns_draft+touchdowns_pre), na.rm = TRUE),
         total_yards_per_game = ((sum(c(yards_draft,yards_pre), na.rm = TRUE)) / total_player_game_count), 
         total_yards_after_catch_per_game = ((sum(c(yards_after_catch_draft+ yards_after_catch_pre), na.rm = TRUE)) /
                                               total_player_game_count), 
         total_targets_per_game = ((sum(c(targets_draft+targets_pre), na.rm = TRUE)) / total_player_game_count), 
         total_targeted_qb_rating = sum(c(targeted_qb_rating_draft+targeted_qb_rating_pre), na.rm = TRUE) / 2,
         games_draft = (player_game_count_draft / sum(c(player_game_count_draft+ player_game_count_pre), na.rm = TRUE)),
         grades_hands_drop = sum(c((games_draft*grades_hands_drop_draft),((1-games_draft)*grades_hands_drop_pre)), 
                                 na.rm = TRUE),
         grades_hands_fumble = sum(c((games_draft*grades_hands_fumble_draft)+((1-games_draft)*grades_hands_fumble_pre)),
                                   na.rm = TRUE),
         grades_offense = sum(c((games_draft*grades_offense_draft)+((1-games_draft)*grades_offense_pre)), na.rm = TRUE),
         grades_pass_route = sum(c((games_draft*grades_pass_route_draft)+((1-games_draft)*grades_pass_route_pre)), 
                                 na.rm = TRUE))

pro_2017 <- read_csv("data/2017_pro_stats.csv")
dc_2017_pro_stats <- pro_2017 %>% 
  inner_join(pro_2018, by = c("player", "position", "player_id"), suffix = c("1yr", "2yr"))
dc_2017_stats <- inner_join(dc_2017_pro_stats, dc2017_stats2016, by = c("player_id", "player", "position")) |>
  select(-c(grades_pass_block1yr, grades_pass_block2yr)) |>
  rowwise() %>% 
  mutate(total_yards = yards1yr + yards2yr,
         total_catch_percent = sum(c(receptions1yr + receptions2yr), na.rm=TRUE) / sum(c(targets1yr + targets2yr),
                                                                                           na.rm = TRUE),
         total_target_percent = sum(c(targets1yr + targets2yr), na.rm = TRUE) / sum(c(routes1yr + routes2yr), 
                                                                                        na.rm = TRUE),
         total_route_percent = sum(c(routes1yr + routes2yr), na.rm = TRUE) / sum(c(pass_plays1yr + pass_plays2yr),
                                                                                     na.rm = TRUE),
         total_drop_percent = sum(c(drops1yr+drops2yr), na.rm = TRUE) / sum(c(targets1yr+targets2yr), na.rm = TRUE),
         total_yprr = yprr1yr + yprr2yr,
         total_first_downs = sum(c(first_downs1yr+first_downs2yr), na.rm = TRUE),
         total_yards_per_reception = sum(c(yards_per_reception1yr+yards_per_reception2yr), na.rm = TRUE),
         total_yards_after_catch_per_reception = sum(c(yards_after_catch_per_reception1yr+
                                                       yards_after_catch_per_reception2yr), na.rm = TRUE),
         total_player_game_count = sum(c(player_game_count1yr+player_game_count2yr), na.rm = TRUE),
         total_touchdowns = sum(c(touchdowns1yr+touchdowns2yr), na.rm = TRUE),
         total_yards_per_game = sum(c(yards1yr+yards2yr), na.rm = TRUE) / total_player_game_count, 
         total_yards_after_catch_per_game = sum(c(yards_after_catch1yr + yards_after_catch2yr), na.rm = TRUE) /
                                               total_player_game_count,
         total_targets_per_game = sum(c(targets1yr + targets2yr), na.rm = TRUE) / total_player_game_count, 
         total_targeted_qb_rating = sum(c(targeted_qb_rating1yr+targeted_qb_rating2yr), na.rm = TRUE) / 2,
         games2yr = (player_game_count2yr / sum(c(player_game_count2yr + player_game_count1yr), na.rm = TRUE)),
         grades_hands_drop = sum(c((games2yr*grades_hands_drop2yr)+((1-games2yr)*grades_hands_drop1yr)), 
                                 na.rm = TRUE),
         grades_hands_fumble = sum(c((games2yr*grades_hands_fumble2yr)+((1-games2yr)*grades_hands_fumble1yr)),
                                   na.rm = TRUE),
         grades_offense = sum(c((games2yr*grades_offense2yr)+((1-games2yr)*grades_offense1yr)), na.rm = TRUE),
         grades_pass_route = sum(c((games2yr*grades_pass_route2yr)+((1-games2yr)*grades_pass_route1yr)), 
                                 na.rm = TRUE))
#2015 Stats of 2016 DC
dc_2016 <- c("Josh Doctson", "Rashard Higgins", "Daniel Braverman", 
             "Sterling Shepard", "Corey Coleman", "Tyler Boyd", "Garrett Brown", 
             "Leonte Carroo", "Tajae Sharpe", "De'Marcus Ayers", "Malcolm Mitchell", 
             "Alex Erickson", "Shaq Washington", "Jordan Payton", "Aaron Burbridge",
             "Mike Thomas", "Laquon Treadwell", "Devin Lucien", "Michael Thomas", 
             "Nelson Spruce", "Pharoh Cooper", "Ricardo Louis", "Canaan Severin", 
             "Keyarris Garrett", "Teddy Ruben", "Hunter Sharp", "Bralon Addison", 
             "Dezmon Epps", "Quinshad Davis", "Jakeem Grant", "Andre Booker", 
             "Casey Martin", "J.D. McKissic", "Jamal Robinson", "De'Runnya Wilson",
             "Rashawn Scott", "Shane Williams-Rhodes", "Jenson Stoshak", 
             "Ron Willoughby", "Chris Brown", "David Glidden", "Thomas Duarte", 
             "Will Fuller V", "Roger Lewis Jr.", "Imani Davis", "Jaydon Mickens",
             "Robbie Anderson", "Jared Dangerfield", "Pierre Youngblood-Ary", 
             "Jordan Thompson", "Ed'Marques Batties", "Darius Powe", "K.J. Maye",
             "Kody Cook", "Johnny Jackson", "Rashon Ceaser", "Josh Grady", 
             "Tres Houston", "Tevaun Smith", "Paul Turner", "Kenny Lawler", 
             "Jordan Williams-Lambert", "Devon Blackmon", "Bryce Treggs", 
             "Von Pearson", "Max Morrison", "Cayleb Jones", "Carlos Wiggins", 
             "Brandon Sheperd", "C.J. Best", "Charone Peake", "Antwane Grant", 
             "Mitch Mathews", "Chris Moore", "Trevor Davis", "Simms McElfresh", 
             "Johnny Holton", "DeAndre Reaves", "Cody Core", "Alonzo Russell", 
             "Donovan Harden", "Maurice Morgan", "Ben Lewis", "Jeff Greene", 
             "Damien Washington", "David Mellstrom", "Kolby Listenbee", 
             "Demarcus Robinson", "Braxton Miller", "Jemond Hazely", "Johnathon Johnson", 
             "Malachi Jones", "Dennis Parks", "Jordan Fredrick", "Devin Fuller", 
             "Mose Frazier", "Davonte Allen", "Brandon Swindall", "Terenn Houk", 
             "Richard Mullaney", "Alex Ludowig", "T.J. Thorpe", "Macgarrett Kings Jr.", 
             "Dom Williams", "Shane Mikesky", "Bubba Poole", "Danny Anthrop", 
             "DeAnthony Arnett", "Herve Coby", "Kenneth Scott", "Justin Berger", 
             "Quinton Pedroza", "Tommylee Lewis", "Daje Johnson", "Devon Cajuste",
             "Maurice Harris", "Chris Kearney", "Montez McGuire", "D'haquille Williams",
             "Joe Hansley", "Geronimo Allison", "Tre' Parmalee", "Jordan Bergstrom",
             "Gary Chambers", "K.J. Brent", "DeAndre Bell", "Trey Page", "Hansell Wilson",
             "Carlos Harris", "Clinton Taylor", "Thomas Wilson", "Brad Pearson", 
             "Byron Marshall", "Rollins Stallworth", "D.J. Foster", "Alex Chisum", 
             "Amir Carlisle", "Quenton Bundrage", "Ryan Burbrink", "Jay Lee", "Durron Neal",
             "David Richards", "Devonte Robinson", "Nathan Sassaman", "John Christopher",
             "Sanford Seay", "Mekale McKay", "Andre Davis", "Valdez Showers", 
             "Marvin Shinn", "Bobo Beathard", "Max McCaffrey", "Damon Graham", 
             "Jafus Gaines", "Aaron Grubb", "Marvin Hall", "Jalin Marshall", 
             "Dustin Creel", "Kevin Asante", "Tevin Jones", "Roger Dixon", 
             "Kyle Klein", "Christian Jones", "Andrew Pratt", "Bryan Holmes", 
             "Jarvis Bentley", "Aaron Criswell", "Elgin Long", "Octavious Andrews",
             "Kishon Wilcher", "Logan Sweet", "Herb Waters", "NaQuan Brown", 
             "Jamal Turner", "Brandon Oliver", "Ryan Garrey", "Ja'Juan Story", 
             "Avery Sweeting", "Tony Ray Parnell", "Brandon Smith", "Jordan Bianchi",
             "Hayden Daniels", "Brandon Shippen", "Danny Woodson II", "Daniel Lilienthal",
             "Conner Floyd", "Alvonta Jenkins", "Marquez North", "P.J. Howard IV",
             "Kawmae Sawyer", "Tanner McEvoy", "Andrew Stone", "Terrell Johnson",
             "Demitri Knowles", "AJ Troup", "Stanton Weber", "Kris Strange", 
             "Marken Michel", "Ryan Longoria", "Juwan Brescacin", "Tyler Scott", 
             "K.D. Edenfield", "Chris Shillings", "Cody Blanc", "Melvin Ray", "Joe Morrow", 
             "Connor Arlia", "Shamier Jeffery", "Marcus Johnson", "Claude Garrett",
             "Taariq Allen", "Christian Collis", "Joshua Bowen", "Wesley Leftwich", 
             "Andre Sims", "KJ Myers", "Tyler Trosin", "Rayvean Moore", "Darius Joseph", 
             "Miles Shuler", "Bobby Swigert", "Kurt Henderson", "Nyiakki Height", 
             "Marquis Bundy", "David Dudeck", "Carlton Heard", "D.J. Vinson", 
             "Garrett Kidd", "Kenny Bias", "Tyler Baker", "Kendrick Roberts", "Ian Dixon", 
             "Justin Johnson")

dc_2016_2 <- c("Sabian Holmes", "Kendrick Singleton", "Cameron Dickerson", 
               "Jacob Hillyer", "Kris Kentera", "Anthony Williams", "Kameron Doolittle",
               "Autrey Golden", "Christian Tober", "Derek Keaton", "Josh Boyle")

dc2016_stats2015 <- stats_2015 %>% 
  filter(player %in% dc_2016 | player %in% dc_2016_2 & position == "WR") %>% 
  left_join(stats_2014, by = c("player", "player_id", "position"), 
            suffix = c("_draft", "_pre")) %>% 
  rowwise() %>% 
  mutate(total_yards = yards_draft + yards_pre,
         total_catch_percent = sum(c(receptions_draft + receptions_pre), na.rm=TRUE) / sum(c(targets_draft + targets_pre),
                                                                                           na.rm = TRUE),
         total_target_percent = sum(c(targets_draft + targets_pre), na.rm = TRUE) / sum(c(routes_draft + routes_pre), 
                                                                                        na.rm = TRUE),
         total_route_percent = sum(c(routes_draft + routes_pre), na.rm = TRUE) / sum(c(pass_plays_draft + pass_plays_pre),
                                                                                     na.rm = TRUE),
         total_drop_percent = sum(c(drops_draft+drops_pre), na.rm = TRUE) / sum(c(targets_draft+targets_pre), na.rm = TRUE),
         total_yprr = yprr_draft + yprr_pre,
         total_first_downs = sum(c(first_downs_draft+first_downs_pre), na.rm = TRUE),
         total_yards_per_reception = sum(c(yards_per_reception_draft+yards_per_reception_pre), na.rm = TRUE),
         total_yards_after_catch_per_reception = sum(c(yards_after_catch_per_reception_draft+
                                                       yards_after_catch_per_reception_pre), na.rm = TRUE),
         total_player_game_count = sum(c(player_game_count_draft+player_game_count_pre), na.rm = TRUE),
         total_touchdowns = sum(c(touchdowns_draft+touchdowns_pre), na.rm = TRUE),
         total_yards_per_game = ((sum(c(yards_draft,yards_pre), na.rm = TRUE)) / total_player_game_count), 
         total_yards_after_catch_per_game = ((sum(c(yards_after_catch_draft+ yards_after_catch_pre), na.rm = TRUE)) /
                                               total_player_game_count), 
         total_targets_per_game = ((sum(c(targets_draft+targets_pre), na.rm = TRUE)) / total_player_game_count), 
         total_targeted_qb_rating = sum(c(targeted_qb_rating_draft+targeted_qb_rating_pre), na.rm = TRUE) / 2,
         games_draft = (player_game_count_draft / sum(c(player_game_count_draft+ player_game_count_pre), na.rm = TRUE)),
         grades_hands_drop = sum(c((games_draft*grades_hands_drop_draft),((1-games_draft)*grades_hands_drop_pre)), 
                                 na.rm = TRUE),
         grades_hands_fumble = sum(c((games_draft*grades_hands_fumble_draft)+((1-games_draft)*grades_hands_fumble_pre)),
                                   na.rm = TRUE),
         grades_offense = sum(c((games_draft*grades_offense_draft)+((1-games_draft)*grades_offense_pre)), na.rm = TRUE),
         grades_pass_route = sum(c((games_draft*grades_pass_route_draft)+((1-games_draft)*grades_pass_route_pre)), 
                                 na.rm = TRUE))
  
pro_2016 <- read_csv("data/2016_pro_stats.csv")
dc_2016_pro_stats <- pro_2016 %>% 
  inner_join(pro_2017, by = c("player", "position", "player_id"), suffix = c("1yr", "2yr"))
dc_2016_stats <- inner_join(dc_2016_pro_stats, dc2016_stats2015, by = c("player_id", "player", "position")) |>
  select(-c(grades_pass_block1yr, grades_pass_block2yr)) |>
  rowwise() %>% 
  mutate(total_yards = yards1yr + yards2yr,
         total_catch_percent = sum(c(receptions1yr + receptions2yr), na.rm=TRUE) / sum(c(targets1yr + targets2yr),
                                                                                           na.rm = TRUE),
         total_target_percent = sum(c(targets1yr + targets2yr), na.rm = TRUE) / sum(c(routes1yr + routes2yr), 
                                                                                        na.rm = TRUE),
         total_route_percent = sum(c(routes1yr + routes2yr), na.rm = TRUE) / sum(c(pass_plays1yr + pass_plays2yr),
                                                                                     na.rm = TRUE),
         total_drop_percent = sum(c(drops1yr+drops2yr), na.rm = TRUE) / sum(c(targets1yr+targets2yr), na.rm = TRUE),
         total_yprr = yprr1yr + yprr2yr,
         total_first_downs = sum(c(first_downs1yr+first_downs2yr), na.rm = TRUE),
         total_yards_per_reception = sum(c(yards_per_reception1yr+yards_per_reception2yr), na.rm = TRUE),
         total_yards_after_catch_per_reception = sum(c(yards_after_catch_per_reception1yr+
                                                       yards_after_catch_per_reception2yr), na.rm = TRUE),
         total_player_game_count = sum(c(player_game_count1yr+player_game_count2yr), na.rm = TRUE),
         total_touchdowns = sum(c(touchdowns1yr+touchdowns2yr), na.rm = TRUE),
         total_yards_per_game = sum(c(yards1yr+yards2yr), na.rm = TRUE) / total_player_game_count, 
         total_yards_after_catch_per_game = sum(c(yards_after_catch1yr + yards_after_catch2yr), na.rm = TRUE) /
                                               total_player_game_count,
         total_targets_per_game = sum(c(targets1yr + targets2yr), na.rm = TRUE) / total_player_game_count, 
         total_targeted_qb_rating = sum(c(targeted_qb_rating1yr+targeted_qb_rating2yr), na.rm = TRUE) / 2,
         games2yr = (player_game_count2yr / sum(c(player_game_count2yr + player_game_count1yr), na.rm = TRUE)),
         grades_hands_drop = sum(c((games2yr*grades_hands_drop2yr)+((1-games2yr)*grades_hands_drop1yr)), 
                                 na.rm = TRUE),
         grades_hands_fumble = sum(c((games2yr*grades_hands_fumble2yr)+((1-games2yr)*grades_hands_fumble1yr)),
                                   na.rm = TRUE),
         grades_offense = sum(c((games2yr*grades_offense2yr)+((1-games2yr)*grades_offense1yr)), na.rm = TRUE),
         grades_pass_route = sum(c((games2yr*grades_pass_route2yr)+((1-games2yr)*grades_pass_route1yr)), 
                                 na.rm = TRUE))
#2014 Stats of 2015 DC
dc_2015 <- c("Amari Cooper", "Tyler Lockett", "DeVante Parker", 
 "Jonathon Rumph", "Nelson Agholor", "Tony Lippett", "DeAndre Smelter", 
 "Titus Davis", "Justin Hardy", "Jaelen Strong", "Darren Waller", 
 "Rashad Greene Sr.", "Devin Smith", "Curry Sexton", "Kenny Bell", 
 "Bud Sasser", "Tommy Shuler", "Ezell Ruffin", "Stefon Diggs", 
 "Matthew Miller", "Kevin White", "Jordan Taylor", "John Harris", 
 "Michael McNeely", "Joshua McCain", "Cam Worthy", "David Frazier", 
 "Lucky Whitehead", "Andre Davis", "Sammie Coates", "Vince Mayle", 
 "Christopher Harper", "Ty Montgomery", "Da'Ron Brown", "Antonio Vaughan",  
 "Chris Conley", "Geremy Davis", "Jamison Crowder", "Darius Jennings", 
 "Shane Wynn", "Jeff Trojan", "Keiwone Malone", "Jalen Claiborne", 
 "Josh Harper", "Vince Sanders", "Bradley Marquez", "Lynquez Blair", 
 "Breshad Perriman", "Devin Funchess", "Phillip Dorsett", "Miles Gooch",
 "Marcus Henry", "Kyle Prater", "Andrew Turzilli", "Keith Mumphery", 
 "Quan Bray", "Jordan Leslie", "Rannell Hall", "Michael Bennett", 
 "Shakim Phillips", "Clay Fuller", "Ronald Butler", "Devante Davis",
 "Ian Hamilton", "Jarrod West", "Isiah Myers", "Jack Rhoades", 
 "Jalen Fitzpatrick", "Dominic Rufran", "Willie McNeal", "Levi Norwood", 
 "Chandler Worthy", "Antwan Goodley", "Earon Holmes", "J.J. Worton", 
 "Jordan Davis", "Deontay Greenberry", "DeAndrew White", "Eli Rogers",
 "Josh Reese", "Joel German", "Kentrellis Showers", "Javess Blue", 
 "Malcome Kennedy", "Devin Clarke", "Demarco Robinson", "Jarred Haggins",
 "George Farmer", "E.J. Scott", "Hunter Lee", "Tyler McCulloch", "Jimmie Hunt",
  "Matt James", "Richy Turner", "Kenzee Jackson", "Devon Hughes", 
 "Jameon Lewis", "Nick Jones", "Manasseh Garner", "Jamarcus Nelson", 
 "Zach D'Orazio", "Sterling Griffin", "Tyler Duncan", "Jaxon Shipley", 
 "Jacob Carter", "Mario Hull", "Demetrius Wilson", "Ben Ijah", "Nigel King", 
 "Willie Byrn", "Jeric Magnant", "Jordan Pratt", "Deon Long", 
 "Cameron Peterson", "Adrian Henderson", "Tacoi Sumler", "Keith Sconiers",
  "Chris Humphrey", "David Porter Jr.")
dc_2015_2 <- c("Nick Stoner", "Issac Blakeney", "Mario Alford", 
  "Isaac Fruechte", "Markese Triplett", "Marcus Cunningham", "Kasen Williams", 
  "Keanon Lowe", "Maudrecus Humphrey", "Justyn Shackleford", "Daniel Spencer",
  "Glenn Coleman", "Josiah Monroe", "Kevonte Martin-Manley", "Zach Walker",
  "Damond Powell", "Scott Harding", "Joe Craig", "Kendall Brock", 
  "Kaelin Clay", "John Chelf", "Dres Anderson", "Nick Harwell", "William Boyd",
  "Andre Lewis", "Kai De La Cruz", "Brendan Dudeck", "Kevin Weatherspoon", 
  "Marcellus Mack", "L.T. Smith", "Alex Kenney", "Dwight Macon", 
  "D.D. Goodson", "Johnathan Loyd", "Keanu Nelson", "Isaiah Roundtree",
  "Kenzel Doe", "Darius Terrell", "Chase Cochran", "Brandon Terry", 
  "Charles Lovett", "Damiere Byrd", "Maika Mataele", "Tony Jones", 
  "B.J. Chitty", "Shane Ros", "Ralph David Abernathy IV", "Terome Grant",
  "Trey Norman", "Jack Spady", "Markeith Ambles", "Tyler Williams", 
  "Der'rikk Thompson", "Christion Jones", "Quinton Dunbar", "Rickey Galvin",
  "John Jakubik", "Brent Mitcham", "Martize Barr", "Deshon Foxx", 
  "Jeremé Jones", "Kristoff Williams", "Donnie King Jr.", "Michael Erdman",
  "Jackie Williams", "Jabari Carr", "Aaron Bradley", "Brandon Freeman", 
  "Austin Hill", "Daniel Bradbury", "Drake Whitehurst", "Andrew Maass",
  "Christian Green", "Kinderick Dent", "Greg Watson", "Seth Grubb", 
  "Jarrad Shaw", "Lonnie Turner", "Clinton Jones", "Justin Olack", 
  "Adam Shapiro", "Wayne Beadle", "Landon Smith", "Jeremiah Kobena", 
  "Demetrius Evans", "DiAndre Campbell", "Jeffrey Jay", "Chris Perkins",
  "Heath Jackson", "Keenan Montgomery", "Evan Spencer", "Jarvis West",
  "Chevaughn Lawrence", "Daniel Rodriguez", "Stephen Nelson", "Kam Jones",
  "T.J. Glover", "Michaelee Harris", "Craig Wilkins", "Adam Humphries", 
  "Rahmaan Patterson", "Matt Milton", "Kenny Harrison", 
  "Courtney Williams", "Robert Johnson", "John Dunmore","Malcolm Trail", 
  "Tyler Allen", "Deonte Welch", "Jake Howton", "Justin McCay", 
  "Adrian Flemming", "William Dukes", "Bryan Underwood", "Trey Wilkins", 
  "Gavin Otte", "Carl Caldwell", "Ross Apo", "Logan Hutton", "Jordan Duval",
  "LeKendrick Williams", "Dallas Burroughs", "Corey Dennis", "Andre Debose")
dc2015_stats2014 <- stats_2014 %>% 
  filter(player %in% dc_2015 | player %in% dc_2015_2 & position == "WR") 
```

### Combine College Stats

```{r}
long_data <- rbind(dc_2016_stats, dc_2017_stats, dc_2018_stats, 
                   dc_2019_stats, dc_2020_stats) #, dc_2021_stats)
long_data <- long_data %>% 
  as.data.frame() %>% 
  filter(position == "WR")
```

### Pro Stats

```{r}
power5 <- c("PITTSBURGH", "MICH STATE", "WASH STATE", "WISCONSIN", "ILLINOIS", "COLORADO", "TEXAS TECH", "UCLA", "OLE MISS", "OKLAHOMA", "BAYLOR", "S CAROLINA", "TCU", "BYU", "MISS STATE", "ARIZONA ST", "WASHINGTON", "ARIZONA", "GEORGIA", "OREGON", "CAL", "N CAROLINA", "MIAMI FL", "AUBURN", "DUKE", "CLEMSON", "NOTRE DAME", "FLORIDA", "IOWA STATE", "IOWA", "OHIO STATE", "RUTGERS", "BOSTON COL", "TENNESSEE", "SYRACUSE", "VA TECH", "USC", "MICHIGAN", "FLORIDA ST", "ARKANSAS", "TEXAS A&M", "W VIRGINIA", "PENN STATE", "UTAH", "ALABAMA", "LOUISVILLE", "LSU", "STANFORD", "OKLA STATE", "INDIANA", "MISSOURI", "KANSAS ST", "KANSAS", "WAKE", "NC STATE", "TEXAS", "MARYLAND", "MINNESOTA", "NEBRASKA", "NORTHWESTERN", "PURDUE", "VIRGINIA", "KENTUCKY", "VANDERBILT", "OREGON ST", "GA TECH")
full_data <- inner_join(long_data, combine_stats, 
                          by = c("player" = "Name")) %>%
  mutate(Power5 = if_else(team_name_draft %in% power5, 1, 0))  %>% 
  distinct(player_id, .keep_all = TRUE) |>
  select(-c(Shuttle, Cone))
full_data$Arm[is.na(full_data$Arm)] <- mean(full_data$Arm,na.rm=TRUE)
full_data$X40.Yard[is.na(full_data$X40.Yard)] <- mean(full_data$X40.Yard,na.rm=TRUE)
full_data$Hand[is.na(full_data$Hand)] <- mean(full_data$Hand,na.rm=TRUE)
```

```{r}
#ggplot(joined_data, aes(x = yprr_pre, y = yprr_draft)) +
  #geom_point()
#ggplot(joined_data, aes(x = total_yards, y = grades_offense)) +
  #geom_point()
#ggplot(joined_data, aes(x = X40.Yard, y = total_yards_per_reception)) +
  #geom_point()
```

```{r}
all_college_data = rbind(dc2016_stats2015, dc2017_stats2016, dc2018_stats2017, dc2019_stats2018, dc2020_stats2019, dc2021_stats2020) %>%
  drop_na(team_name_pre) %>% 
  mutate(Power5_draft = if_else(team_name_draft %in% power5, 1, 0),
         Power5_pre = if_else(team_name_pre %in% power5, 1, 0))
combine_college_data = inner_join(all_college_data, combine_stats, by = c("player" = "Name"))
```

### Model Response Variables

To measure success

```{r}
full_data$playedA_Yr <- with(full_data, ifelse(player_game_count1yr > 0 | player_game_count2yr > 0, 1, 0))
full_data$scoredTouchDown <- with(full_data, ifelse(touchdowns1yr > 0 | touchdowns2yr > 0, 1, 0))
full_data$decentStarter <- with(full_data, ifelse(yards1yr > 100 | yards2yr > 100, 1, 0))
full_data$greatStarter <- with(full_data, ifelse(yards1yr > 500 | yards2yr > 500, 1, 0))
full_data$eliteStarter <- with(full_data, ifelse(yards1yr > 1000 | yards2yr > 1000 | (yards1yr + yards1yr) > 1500, 1, 0))
```

```{r}
response_data <- full_data %>% 
  select(player_id, playedA_Yr, scoredTouchDown, decentStarter, greatStarter, eliteStarter)
```

## Predicting NFL Success for NFL Players

*more interested in modeling Elite starter and great starter, might need to add some more response variables for higher thresholds

```{r}
full_data %>% 
  head()
```

```{r good starter model}
good_starter_nfl <- full_data %>% 
  select(-c(player_id, player, position, team_name_draft, scoredTouchDown, playedA_Yr, decentStarter, eliteStarter))
```

```{r elite starter}
elite_starter_nfl <- full_data %>% 
  select(-c(player_id, player, position, team_name_draft, scoredTouchDown, playedA_Yr, decentStarter, greatStarter))
```




## Predicting NFL Success for Players at Combine

*more interested in modeling great and good starter, played a year, contributor 

```{r}
combine_data <- combine_college_data %>% 
  merge(response_data, by = 'player_id', all.x = TRUE) %>% 
  distinct(player_id, .keep_all = TRUE) %>% 
  drop_na(grades_offense_pre) %>% 
  mutate(playedA_Yr = coalesce(playedA_Yr, 0),
         scoredTouchDown = coalesce(scoredTouchDown, 0),
         decentStarter = coalesce(decentStarter, 0),
         greatStarter = coalesce(greatStarter, 0),
         eliteStarter = coalesce(eliteStarter, 0))

combine_cleaned <- combine_data |>
  select(-c(Shuttle, Cone, Bench))

combine_cleaned$X40.Yard[is.na(combine_cleaned$X40.Yard)]<-mean(combine_cleaned$X40.Yard,na.rm=TRUE)
combine_cleaned$Arm[is.na(combine_cleaned$Arm)]<-mean(combine_cleaned$Arm, na.rm=TRUE)
combine_cleaned$Broad[is.na(combine_cleaned$Broad)]<-mean(combine_cleaned$Broad, na.rm=TRUE)
combine_cleaned$Vertical[is.na(combine_cleaned$Vertical)]<-mean(combine_cleaned$Vertical, na.rm=TRUE)
combine_cleaned$Hand[is.na(combine_cleaned$Hand)]<-mean(combine_cleaned$Hand, na.rm=TRUE)
```

```{r snap model}
snap_model_com <- combine_cleaned %>% 
  select(-c(player_id, player, position, team_name_draft, scoredTouchDown, decentStarter, greatStarter, eliteStarter))
```

```{r decent starter model}
decent_starter_com <- combine_cleaned %>% 
  select(-c(player_id, player, position, team_name_draft, scoredTouchDown, playedA_Yr, greatStarter, eliteStarter))
```

```{r great starter}
great_starter_com <- combine_cleaned %>% 
  select(-c(player_id, player, position, team_name_draft, scoredTouchDown, playedA_Yr, decentStarter, eliteStarter))
```


## Predicting NFL Success for Players in College

*more interested in modeling great and decent starter, played a year, contributor 

```{r}
college_data <- all_college_data %>% 
  merge(response_data, by = 'player_id', all.x = TRUE) %>% 
  distinct(player_id, .keep_all = TRUE) %>% 
  drop_na(grades_offense_pre) %>% 
  mutate(playedA_Yr = coalesce(playedA_Yr, 0),
         scoredTouchDown = coalesce(scoredTouchDown, 0),
         decentStarter = coalesce(decentStarter, 0),
         greatStarter = coalesce(greatStarter, 0),
         eliteStarter = coalesce(eliteStarter, 0))
college_data %>% 
  head()
```

```{r snap model}
snap_model_coll <- college_data %>% 
  select(-c(player_id, player, position, team_name_draft, scoredTouchDown, decentStarter, greatStarter, eliteStarter))
```

```{r decent starter model}
decent_starter_coll <- college_data %>% 
  select(-c(player_id, player, position, team_name_draft, scoredTouchDown, playedA_Yr, greatStarter, eliteStarter))
```

```{r great starter}
great_starter_coll <- college_data %>% 
  select(-c(player_id, player, position, team_name_draft, scoredTouchDown, playedA_Yr, decentStarter, eliteStarter))
```

