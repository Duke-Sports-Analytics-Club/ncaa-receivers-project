---
title: "Predicting NFL Wide Receiver Success Using Combine Measurables and PFF College Data"
author: "Jack Miller, Nahm Lahade, Matther Paul, Caspian Svenson"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load packages, warning = FALSE, message=FALSE}
library(tidyverse)
library(tidyr)
library(readr)
library(dplyr)
library(broom)
library(knitr)
library(nflfastR)
library(nflplotR)
library(ggrepel)
```

```{r load PFF data}
rec_2014 <- read.csv("data_pff_receiver/2014_receiver_pff_data.csv")
rec_2015 <- read.csv("data_pff_receiver/2015_receiver_pff_data.csv")
rec_2016 <- read.csv("data_pff_receiver/2016_receiver_pff_data.csv")
rec_2017 <- read.csv("data_pff_receiver/2017_receiver_pff_data.csv")
rec_2018 <- read.csv("data_pff_receiver/2018_receiver_pff_data.csv")
rec_2019 <- read.csv("data_pff_receiver/2019_receiver_pff_data.csv")
rec_2020 <- read.csv("data_pff_receiver/2020_receiver_pff_data.csv")
con_2014 <- read.csv("data_pff_receiver/2014_receiving_concept.csv")
con_2015 <- read.csv("data_pff_receiver/2015_receiving_concept.csv")
con_2016 <- read.csv("data_pff_receiver/2016_receiving_concept.csv")
con_2017 <- read.csv("data_pff_receiver/2017_receiving_concept.csv")
con_2018 <- read.csv("data_pff_receiver/2018_receiving_concept.csv")
con_2019 <- read.csv("data_pff_receiver/2019_receiving_concept.csv")
con_2020 <- read.csv("data_pff_receiver/2020_receiving_concept.csv")
dep_2014 <- read.csv("data_pff_receiver/2014_receiving_depth.csv")
dep_2015 <- read.csv("data_pff_receiver/2015_receiving_depth.csv")
dep_2016 <- read.csv("data_pff_receiver/2016_receiving_depth.csv")
dep_2017 <- read.csv("data_pff_receiver/2017_receiving_depth.csv")
dep_2018 <- read.csv("data_pff_receiver/2018_receiving_depth.csv")
dep_2019 <- read.csv("data_pff_receiver/2019_receiving_depth.csv")
dep_2020 <- read.csv("data_pff_receiver/2020_receiving_depth.csv")
sch_2015 <- read.csv("data_pff_receiver/2015_receiver_scheme.csv")
sch_2016 <- read.csv("data_pff_receiver/2016_receiving_scheme.csv")
sch_2017 <- read.csv("data_pff_receiver/2017_receiving_scheme.csv")
sch_2018 <- read.csv("data_pff_receiver/2018_receiving_scheme.csv")
sch_2019 <- read.csv("data_pff_receiver/2019_receiving_scheme.csv")
sch_2020 <- read.csv("data_pff_receiver/2020_receiving_scheme.csv")
```

```{r merge PFF data}
#2020 Stats
sta_sch_2020 <- left_join(rec_2020, sch_2020, copy = FALSE, 
                          by = c("player", "position", "team_name",
                                 "player_game_count", "player_id",
                                 "declined_penalties", "franchise_id")) 
con_dep_2020 <- left_join(con_2020, dep_2020, copy = FALSE, 
                          by = c("player", "position", "team_name", "player_game_count", "player_id", "declined_penalties", "franchise_id"))
stats_2020 <- left_join(sta_sch_2020, con_dep_2020, copy = FALSE, 
                        by = c("player", "position", "team_name", "player_game_count", "player_id", "declined_penalties", "franchise_id"))

#2019 Stats
sta_sch_2019 <- left_join(rec_2019, sch_2019, copy = FALSE, 
                          by = c("player", "position", "team_name", "player_game_count", "player_id", "declined_penalties", "franchise_id")) 

con_dep_2019 <- left_join(con_2019, dep_2019, copy = FALSE, 
                          by = c("player", "position", "team_name", "player_game_count", "player_id", "declined_penalties", "franchise_id"))
stats_2019 <- left_join(sta_sch_2019, con_dep_2019, copy = FALSE, 
                        by = c("player", "position", "team_name",
                               "player_game_count", "player_id",
                               "declined_penalties", "franchise_id"))

#2017 Stats
sta_sch_2017 <- left_join(rec_2017, sch_2017, copy = FALSE, by = c("player", "position", "team_name", "player_game_count", "player_id", "declined_penalties", "franchise_id")) 
con_dep_2017 <- left_join(con_2017, dep_2017, copy = FALSE, by = c("player", "position", "team_name", "player_game_count", "player_id", "declined_penalties", "franchise_id"))
stats_2017 <- left_join(sta_sch_2017, con_dep_2017, copy = FALSE, 
                        by = c("player", "position", "team_name", "player_game_count", "player_id", "declined_penalties", "franchise_id"))

#2015 Stats
sta_sch_2015 <- left_join(rec_2015, sch_2015, copy = FALSE, by = c("player", "position", "team_name", "player_game_count", "player_id", "declined_penalties", "franchise_id")) 
con_dep_2015 <- left_join(con_2015, dep_2015, copy = FALSE, by = c("player", "position", "team_name", "player_game_count", "player_id", "declined_penalties", "franchise_id"))
stats_2015 <- left_join(sta_sch_2015, con_dep_2015, copy = FALSE, 
                        by = c("player", "position", "team_name", "player_game_count", "player_id", "declined_penalties", "franchise_id"))

#2014 Stats
con_dep_2014 <- left_join(con_2014, dep_2014, copy = FALSE, by = c("player", "position", "team_name", "player_game_count", "player_id", "declined_penalties", "franchise_id"))
stats_2014 <- left_join(rec_2014, con_dep_2014, copy = FALSE, 
                        by = c("player", "position", "team_name", "player_game_count", "player_id", "declined_penalties", "franchise_id"))


```

```{r players by draft class}
#2015 Stats of 2016 DC
dc_2016 <- c("Josh Doctson", "Rashard Higgins", "Daniel Braverman", "Sterling Shepard", "Corey Coleman", "Tyler Boyd", "Garrett Brown", "Leonte Carroo", "Tajae Sharpe", "De'Marcus Ayers", "Malcolm Mitchell", "Alex Erickson", "Shaq Washington", "Jordan Payton", "Aaron Burbridge", "Mike Thomas", "Laquon Treadwell", "Devin Lucien", "Michael Thomas", "Nelson Spruce", "Pharoh Cooper", "Ricardo Louis", "Canaan Severin", "Keyarris Garrett", "Teddy Ruben", "Hunter Sharp", "Bralon Addison", "Dezmon Epps", "Quinshad Davis", "Jakeem Grant", "Andre Booker", "Casey Martin", "J.D. McKissic", "Jamal Robinson", "De'Runnya Wilson", "Rashawn Scott", "Shane Williams-Rhodes", "Jenson Stoshak", "Ron Willoughby", "Chris Brown", "David Glidden", "Thomas Duarte", "Will Fuller V", "Roger Lewis Jr.", "Imani Davis", "Jaydon Mickens", "Robbie Anderson", "Jared Dangerfield", "Pierre Youngblood-Ary", "Jordan Thompson", "Ed'Marques Batties", "Darius Powe", "K.J. Maye", "Kody Cook", "Johnny Jackson", "Rashon Ceaser", "Josh Grady", "Tres Houston", "Tevaun Smith", "Paul Turner", "Kenny Lawler", "Jordan Williams-Lambert", "Devon Blackmon", "Bryce Treggs", "Von Pearson", "Max Morrison", "Cayleb Jones", "Carlos Wiggins", "Brandon Sheperd", "C.J. Best", "Charone Peake", "Antwane Grant", "Mitch Mathews", "Chris Moore", "Trevor Davis", "Simms McElfresh", "Johnny Holton", "DeAndre Reaves", "Cody Core", "Alonzo Russell", "Donovan Harden", "Maurice Morgan", "Ben Lewis", "Jeff Greene", "Damien Washington", "David Mellstrom", "Kolby Listenbee", "Demarcus Robinson", "Braxton Miller", "Jemond Hazely", "Johnathon Johnson", "Malachi Jones", "Dennis Parks", "Jordan Fredrick", "Devin Fuller", "Mose Frazier", "Davonte Allen", "Brandon Swindall", "Terenn Houk", "Richard Mullaney", "Alex Ludowig", "T.J. Thorpe", "Macgarrett Kings Jr.", "Dom Williams", "Shane Mikesky", "Bubba Poole", "Danny Anthrop", "DeAnthony Arnett", "Herve Coby", "Kenneth Scott", "Justin Berger", "Quinton Pedroza", "Tommylee Lewis", "Daje Johnson", "Devon Cajuste", "Maurice Harris", "Chris Kearney", "Montez McGuire", "D'haquille Williams", "Joe Hansley", "Geronimo Allison", "Tre' Parmalee", "Jordan Bergstrom", "Gary Chambers", "K.J. Brent", "DeAndre Bell", "Trey Page", "Hansell Wilson", "Carlos Harris", "Clinton Taylor", "Thomas Wilson", "Brad Pearson", "Byron Marshall", "Rollins Stallworth", "D.J. Foster", "Alex Chisum", "Amir Carlisle", "Quenton Bundrage", "Ryan Burbrink", "Jay Lee", "Durron Neal", "David Richards", "Devonte Robinson", "Nathan Sassaman", "John Christopher", "Sanford Seay", "Mekale McKay", "Andre Davis", "Valdez Showers", "Marvin Shinn", "Bobo Beathard", "Max McCaffrey", "Damon Graham", "Jafus Gaines", "Aaron Grubb", "Marvin Hall", "Jalin Marshall", "Dustin Creel", "Kevin Asante", "Tevin Jones", "Roger Dixon", "Kyle Klein", "Christian Jones", "Andrew Pratt", "Bryan Holmes", "Jarvis Bentley", "Aaron Criswell", "Elgin Long", "Octavious Andrews", "Kishon Wilcher", "Logan Sweet", "Herb Waters", "NaQuan Brown", "Jamal Turner", "Brandon Oliver", "Ryan Garrey", "Ja'Juan Story", "Avery Sweeting", "Tony Ray Parnell", "Brandon Smith", "Jordan Bianchi", "Hayden Daniels", "Brandon Shippen", "Danny Woodson II", "Daniel Lilienthal", "Conner Floyd", "Alvonta Jenkins", "Marquez North", "P.J. Howard IV", "Kawmae Sawyer", "Tanner McEvoy", "Andrew Stone", "Terrell Johnson", "Demitri Knowles", "AJ Troup", "Stanton Weber", "Kris Strange", "Marken Michel", "Ryan Longoria", "Juwan Brescacin", "Tyler Scott", "K.D. Edenfield", "Chris Shillings", "Cody Blanc", "Melvin Ray", "Joe Morrow", "Connor Arlia", "Shamier Jeffery", "Marcus Johnson", "Claude Garrett", "Taariq Allen", "Christian Collis", "Joshua Bowen", "Wesley Leftwich", "Andre Sims", "KJ Myers", "Tyler Trosin", "Rayvean Moore", "Darius Joseph", "Miles Shuler", "Bobby Swigert", "Kurt Henderson", "Nyiakki Height", "Marquis Bundy", "David Dudeck", "Carlton Heard", "D.J. Vinson", "Garrett Kidd", "Kenny Bias", "Tyler Baker", "Kendrick Roberts", "Ian Dixon", "Justin Johnson")
dc_2016_2 <- c("Sabian Holmes", "Kendrick Singleton", "Cameron Dickerson", "Jacob Hillyer", "Kris Kentera", "Anthony Williams", "Kameron Doolittle", "Autrey Golden", "Christian Tober", "Derek Keaton", "Josh Boyle")
dc2016_stats2015 <- stats_2015 %>% 
  filter(player %in% dc_2016 | player %in% dc_2016_2)

#2014 Stats of 2015 DC
dc_2015 <- c("Amari Cooper", "Tyler Lockett", "DeVante Parker", 
 "Jonathon Rumph", "Nelson Agholor", "Tony Lippett", "DeAndre Smelter", 
 "Titus Davis", "Justin Hardy", "Jaelen Strong", "Darren Waller", 
 "Rashad Greene Sr.", "Devin Smith", "Curry Sexton", "Kenny Bell", 
 "Bud Sasser", "Tommy Shuler", "Ezell Ruffin", "Stefon Diggs", 
 "Matthew Miller", "Kevin White", "Jordan Taylor", "John Harris", 
 "Michael McNeely", "Joshua McCain", "Cam Worthy", "David Frazier", 
 "Lucky Whitehead", "Andre Davis", "Sammie Coates", "Vince Mayle", 
 "Christopher Harper", "Ty Montgomery", "Da'Ron Brown", "Antonio Vaughan",  
 "Chris Conley", "Geremy Davis", "Jamison Crowder", "Darius Jennings", 
 "Shane Wynn", "Jeff Trojan", "Keiwone Malone", "Jalen Claiborne", 
 "Josh Harper", "Vince Sanders", "Bradley Marquez", "Lynquez Blair", 
 "Breshad Perriman", "Devin Funchess", "Phillip Dorsett", "Miles Gooch",
 "Marcus Henry", "Kyle Prater", "Andrew Turzilli", "Keith Mumphery", 
 "Quan Bray", "Jordan Leslie", "Rannell Hall", "Michael Bennett", 
 "Shakim Phillips", "Clay Fuller", "Ronald Butler", "Devante Davis",
 "Ian Hamilton", "Jarrod West", "Isiah Myers", "Jack Rhoades", 
 "Jalen Fitzpatrick", "Dominic Rufran", "Willie McNeal", "Levi Norwood", 
 "Chandler Worthy", "Antwan Goodley", "Earon Holmes", "J.J. Worton", 
 "Jordan Davis", "Deontay Greenberry", "DeAndrew White", "Eli Rogers",
 "Josh Reese", "Joel German", "Kentrellis Showers", "Javess Blue", 
 "Malcome Kennedy", "Devin Clarke", "Demarco Robinson", "Jarred Haggins",
 "George Farmer", "E.J. Scott", "Hunter Lee", "Tyler McCulloch", "Jimmie Hunt",
  "Matt James", "Richy Turner", "Kenzee Jackson", "Devon Hughes", 
 "Jameon Lewis", "Nick Jones", "Manasseh Garner", "Jamarcus Nelson", 
 "Zach D'Orazio", "Sterling Griffin", "Tyler Duncan", "Jaxon Shipley", 
 "Jacob Carter", "Mario Hull", "Demetrius Wilson", "Ben Ijah", "Nigel King", 
 "Willie Byrn", "Jeric Magnant", "Jordan Pratt", "Deon Long", 
 "Cameron Peterson", "Adrian Henderson", "Tacoi Sumler", "Keith Sconiers",
  "Chris Humphrey", "David Porter Jr.")
dc_2015_2 <- c("Nick Stoner", "Issac Blakeney", "Mario Alford", 
  "Isaac Fruechte", "Markese Triplett", "Marcus Cunningham", "Kasen Williams", 
  "Keanon Lowe", "Maudrecus Humphrey", "Justyn Shackleford", "Daniel Spencer",
  "Glenn Coleman", "Josiah Monroe", "Kevonte Martin-Manley", "Zach Walker",
  "Damond Powell", "Scott Harding", "Joe Craig", "Kendall Brock", 
  "Kaelin Clay", "John Chelf", "Dres Anderson", "Nick Harwell", "William Boyd",
  "Andre Lewis", "Kai De La Cruz", "Brendan Dudeck", "Kevin Weatherspoon", 
  "Marcellus Mack", "L.T. Smith", "Alex Kenney", "Dwight Macon", 
  "D.D. Goodson", "Johnathan Loyd", "Keanu Nelson", "Isaiah Roundtree",
  "Kenzel Doe", "Darius Terrell", "Chase Cochran", "Brandon Terry", 
  "Charles Lovett", "Damiere Byrd", "Maika Mataele", "Tony Jones", 
  "B.J. Chitty", "Shane Ros", "Ralph David Abernathy IV", "Terome Grant",
  "Trey Norman", "Jack Spady", "Markeith Ambles", "Tyler Williams", 
  "Der'rikk Thompson", "Christion Jones", "Quinton Dunbar", "Rickey Galvin",
  "John Jakubik", "Brent Mitcham", "Martize Barr", "Deshon Foxx", 
  "Jeremé Jones", "Kristoff Williams", "Donnie King Jr.", "Michael Erdman",
  "Jackie Williams", "Jabari Carr", "Aaron Bradley", "Brandon Freeman", 
  "Austin Hill", "Daniel Bradbury", "Drake Whitehurst", "Andrew Maass",
  "Christian Green", "Kinderick Dent", "Greg Watson", "Seth Grubb", 
  "Jarrad Shaw", "Lonnie Turner", "Clinton Jones", "Justin Olack", 
  "Adam Shapiro", "Wayne Beadle", "Landon Smith", "Jeremiah Kobena", 
  "Demetrius Evans", "DiAndre Campbell", "Jeffrey Jay", "Chris Perkins",
  "Heath Jackson", "Keenan Montgomery", "Evan Spencer", "Jarvis West",
  "Chevaughn Lawrence", "Daniel Rodriguez", "Stephen Nelson", "Kam Jones",
  "T.J. Glover", "Michaelee Harris", "Craig Wilkins", "Adam Humphries", 
  "Rahmaan Patterson", "Matt Milton", "Kenny Harrison", 
  "Courtney Williams", "Robert Johnson", "John Dunmore","Malcolm Trail", 
  "Tyler Allen", "Deonte Welch", "Jake Howton", "Justin McCay", 
  "Adrian Flemming", "William Dukes", "Bryan Underwood", "Trey Wilkins", 
  "Gavin Otte", "Carl Caldwell", "Ross Apo", "Logan Hutton", "Jordan Duval",
  "LeKendrick Williams", "Dallas Burroughs", "Corey Dennis", "Andre Debose")
dc2015_stats2014 <- stats_2014 %>% 
  filter(player %in% dc_2015 | player %in% dc_2015_2)
```






